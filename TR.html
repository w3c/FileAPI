<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>File API</title>

    <meta name="revision" content="$Id$" />

    <link rel="stylesheet" href="FileAPI.css" type="text/css" />
    <script src="section-links.js" type="application/ecmascript"></script>
    <script src="dfn.js" type="application/ecmascript"></script>
    <!--[if IE]>
    <style type='text/css'>
      .ignore {
        -ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=50)";
        filter: alpha(opacity=50);
      }
    </style>
    <![endif]-->

    
  <link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/W3C-WD" type="text/css" /></head>

  <body><div class="head">

  <p>
   <a href="http://www.w3.org/"><img width="72" height="48" src="https://www.w3.org/Icons/w3c_home" alt="W3C"/></a>
  </p>
  <h1 class="title p-name" id="title">File API</h1>
  
  <h2 id="w3c-working-draft-21-april-2015"><abbr title="World Wide Web Consortium">W3C</abbr> Working Draft <em>21 April 2015</em></h2>
  <dl>
      <dt>This version:</dt>
      <dd><a class="u-url" href="http://www.w3.org/TR/2015/WD-FileAPI-20150421/">http://www.w3.org/TR/2015/WD-FileAPI-20150421/</a></dd>
      <dt>Latest published version:</dt>
      <dd><a href="http://www.w3.org/TR/FileAPI/">http://www.w3.org/TR/FileAPI/</a></dd>
    
      <dt>Latest editor's draft:</dt>
      <dd><a href="https://w3c.github.io/FileAPI/">https://w3c.github.io/FileAPI/</a></dd>
    
      <dt>Test suite:</dt>
      <dd><a href="http://w3c-test.org/FileAPI/">http://w3c-test.org/FileAPI/</a></dd>
    
      <dt>Previous version:</dt>
      <dd><a rel="dcterms:replaces" href="http://www.w3.org/TR/2013/WD-FileAPI-20130912/">http://www.w3.org/TR/2013/WD-FileAPI-20130912/</a></dd>
    
      <dt>Editors:</dt>
        <dd class="p-author h-card vcard"><span><a class="u-url url p-name fn" href="http://arunranga.com/">Arun Ranganathan</a>, Mozilla Corporation, &lt;arun@mozilla.com&gt;</span>

        </dd>

     <dt>Repository and Participation:</dt>
      <dd>
        <a href="https://github.com/w3c/FileAPI/">We are on github.</a></dd>
      <dd>
        <a href="https://github.com/w3c/FileAPI/issues">File a bug/issue.</a></dd>
      <dd>
        <a href="https://github.com/w3c/FileAPI/commits">Commit history.</a> </dd>
      <dd>
        <a href="https://www.w3.org/Search/Mail/Public/search?keywords=&amp;hdr-1-name=subject&amp;hdr-1-query=FileAPI&amp;index-grp=Public_FULL&amp;index-type=t&amp;type-index=public-webapps">Mailing list search.</a> </dd>
  </dl>
    
      <p class="copyright">
        <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> ©
        2015
        
        <a href="http://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup>
        (<a href="http://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>,
        <a href="http://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>,
        <a href="http://www.keio.ac.jp/">Keio</a>, <a href="http://ev.buaa.edu.cn/">Beihang</a>). 
        
        <abbr title="World Wide Web Consortium">W3C</abbr> <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>,
        <a href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and
        
          <a href="http://www.w3.org/Consortium/Legal/copyright-documents">document use</a>
        
        rules apply.
      </p>
    </div>
  <hr />

  <div>
    <div class="section">
      <h2>Abstract</h2>
     <p>
      This specification provides an <acronym title="Application Programming Interface">API</acronym>
      for representing file objects in web applications, as well as programmatically selecting them and accessing their data.  This includes:

    </p>
	<ul>
	    <li>A <a class="dfnref" href="#dfn-filelist">FileList</a> interface, which represents an array of individually selected files from the underlying system.
		The user interface for selection can be invoked via <code>&lt;input type="file"&gt;</code>, i.e. when the
		<code>input</code> element is in the <code>File Upload</code> state [<a href="#HTML">HTML</a>] .</li>
	    <li>A <a class="dfnref" href="#dfn-Blob">Blob</a> interface, which represents immutable raw binary data, and allows access to ranges of bytes within the
	    <a href="#dfn-Blob"><code>Blob</code></a> object as a separate <a class="dfnref" href="#dfn-Blob">Blob</a>.</li>
            <li>A <a href="#dfn-file" class="dfnref">File</a> interface, which includes readonly informational attributes about a file
	        such as its name and the date of the last modification (on disk) of the file.</li>
            <li>A <a href="#dfn-filereader" class="dfnref">FileReader</a> interface, which provides methods to read a
            <a href="#dfn-file">File</a> or a <a href="#dfn-Blob">Blob</a>, and an event model to obtain the results of these reads.</li>
            <li>A <a href="#url" class="dfnref">URL scheme</a> for use with binary data such as files, so that they can be referenced within web applications.</li>


        </ul>
        <p>Additionally, this specification defines objects to be used within threaded web applications for the synchronous reading of files.</p>
  
  <p>The section on Requirements and Use Cases [<a href="#requirements">REQ</a>] covers the motivation behind this specification.</p>
    <p>
      This API is designed to be used in conjunction with other APIs and elements on the web platform,
      notably: <a href="#XHR" class="dfnref">XMLHttpRequest</a> (e.g.  with an overloaded <code>send()</code>
      method for File or <a href="#dfn-Blob"><code>Blob</code></a> arguments), <code>postMessage</code>, <code>DataTransfer</code> (part
      of the <em>drag and drop API</em> defined in [<a href="#HTML">HTML</a>]) and
      <a href="#Workers">Web Workers</a>. Additionally, it should be possible to programmatically obtain a list of files from the
      <code>input</code> element when it is
      in the <code>File Upload state</code>[<a href="#HTML">HTML</a>].
      These kinds of behaviors are defined in the appropriate affiliated specifications.
    </p>

      
    </div>

    <div class="section">
      <h2 id="status">Status of this Document</h2>

        <p>
          <em>This section describes the status of this document at the time of its publication.
          Other documents may supersede this document. A list of current <abbr title="World Wide Web Consortium">W3C</abbr> publications and the
          latest revision of this technical report can be found in the <a href="http://www.w3.org/TR/"><abbr title="World Wide Web Consortium">W3C</abbr> technical reports index</a> at
          http://www.w3.org/TR/.</em>
        </p>
        
      If you have comments for this spec, please create new discuss here
      <a href="https://github.com/w3c/FileAPI/issues">https://github.com/w3c/FileAPI/issues</a>
      with a Subject: prefix of <code>[FileAPI]</code>. See
      <a href="https://www.w3.org/Bugs/Public/buglist.cgi?product=WebAppsWG&amp;component=FileAPI&amp;resolution=---">Bugzilla</a> 
      for this specification's open bugs.
    
        <p>
          This document was published by the <a href="http://www.w3.org/2008/webapps/">Web Applications Working Group</a> as a Working Draft.
          
            This document is intended to become a <abbr title="World Wide Web Consortium">W3C</abbr> Recommendation.
          
            If you wish to make comments regarding this document, please send them to 
             <a href="https://github.com/w3c/FileAPI/issues">https://github.com/w3c/FileAPI/issues</a>
            (<a href="mailto:public-webapps-request@w3.org?subject=subscribe">subscribe</a>,
            <a href="http://lists.w3.org/Archives/Public/public-webapps/">archives</a>).
            
            All comments are welcome.
        </p>
        
          <p>
            Publication as a Working Draft does not imply endorsement by the <abbr title="World Wide Web Consortium">W3C</abbr>
            Membership. This is a draft document and may be updated, replaced or obsoleted by other
            documents at any time. It is inappropriate to cite this document as other than work in
            progress.
          </p>
        
        <p>
            This document was produced by a group operating under the 
            <a id="sotd_patent" href="http://www.w3.org/Consortium/Patent-Policy-20040205/">5 February 2004 <abbr title="World Wide Web Consortium">W3C</abbr> Patent
            Policy</a>.
          
              <abbr title="World Wide Web Consortium">W3C</abbr> maintains a <a href="http://www.w3.org/2004/01/pp-impl/42538/status" rel="disclosure">public list of any patent
              disclosures</a> 
            
            made in connection with the deliverables of the group; that page also includes
            instructions for disclosing a patent. An individual who has actual knowledge of a patent
            which the individual believes contains
            <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">Essential
            Claim(s)</a> must disclose the information in accordance with
            <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">section
            6 of the <abbr title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>.
          
        </p>
        
          <p>This document is governed by the <a id="w3c_process_revision" href="http://www.w3.org/2014/Process-20140801/">1 August 2014 <abbr title="World Wide Web Consortium">W3C</abbr> Process Document</a>.
          </p>
        
    </div>

    <div id="toc">
      <h2>Table of Contents</h2>
      <div class="toc">
        <ul>
          <li><a href="#introduction">1. Introduction</a></li>
          <li><a href="#conformance">2. Conformance</a></li>
          <li><a href="#dependencies">3. Dependencies</a></li>
          <li><a href="#terminology">4. Terminology</a></li>
          <li><a href="#blob">5. The Blob Interface and Binary Data</a>
            <ul>
              <li><a href="#constructorBlob">5.1. Constructors</a>
                <ul>
                  <li><a href="#constructorParams">5.1.1. Constructor Parameters</a></li>
                </ul></li>
              <li><a href="#attributes-blob">5.2. Attributes</a></li>
              <li><a href="#methodsandparams-blob">5.3. Methods and Parameters</a>
                <ul>
                  <li><a href="#slice-method-algo">5.3.1. The slice method</a></li>
                  <li><a href="#close-method">5.3.2. The close method</a></li>
                </ul>
            </li>
          </ul></li>
        <li><a href="#file">6. The File Interface</a>
          <ul><li><a href="#file-constructor">6.1 File Constructor</a></li>
            <li><a href="#file-attrs">6.2. Attributes</a></li>
          </ul></li>
        <li><a href="#filelist-section">7. The FileList Interface</a>
          <ul><li><a href="#attributes-filelist">7.1. Attributes</a></li>
            <li><a href="#filelist-methods-params">7.2. Methods and Parameters</a></li>
          </ul></li>
            <li><a href="#reading-data-section">8. Reading Data</a>
            <ul>
              <li><a href="#readOperationSection">8.1 The Read Operation</a></li>
              <li><a href="#blobreader-task-source">8.2. The File Reading Task Source</a></li>
              <li><a href="#APIASynch">8.3. FileReader</a>
              <ul>   
                <li><a href="#filereaderConstrctr">8.3.1. Constructors</a></li>
                <li><a href="#event-handler-attributes-section">8.3.2. Event Handler Attributes</a></li>
                <li><a href="#blobreader-state">8.3.3. FileReader States</a></li>
                <li><a href="#reading-a-file">8.3.4. Reading a File or Blob</a>
                  <ul>
                    <li><a href="#filedata-attr">8.3.4.1. The result attribute</a></li>
                    <li><a href="#readAsDataURL">8.3.4.2. The readAsDataURL(blob) method</a></li>
                    <li><a href="#readAsDataText">8.3.4.3. The readAsText(blob, label) method</a></li>
                    <li><a href="#readAsArrayBuffer">8.3.4.4. The readAsArrayBuffer(blob) method</a></li>
                    <li><a href="#dfn-error-steps">8.3.4.5. Error Steps</a></li>
                    <li><a href="#abort">8.3.4.6. The abort() method</a></li>
                  </ul></li>
                </ul></li>
               <li><a href="#enctype">8.4. Determining Encoding</a></li>
               <li><a href="#events">8.5. Events</a>
                  <ul>
                      <li><a href="#event-summary">8.5.1. Event Summary</a></li>
                      <li><a href="#eventInvariants">8.5.2. Summary of Event Invariants</a></li>
                  </ul>
                </li>
                
              <li><a href="#readingOnThreads">8.6. Reading on Threads</a>
                <ul>
                  <li><a href="#FileReaderSync">8.6.1. The FileReaderSync Interface</a>
                      <ul>
                        <li><a href="#filereadersyncConstrctr">8.6.1.1. Constructors</a></li>
                        <li><a href="#readAsTextSync">8.6.1.2. The readAsText method</a></li>
                        <li><a href="#readAsDataURLSync-section">8.6.1.3. The readAsDataURL method</a></li>
                        <li><a href="#readAsArrayBufferSyncSection">8.6.1.4. The readAsArrayBuffer method</a></li>
                      </ul></li>
                  </ul></li>
                </ul></li>
              <li><a href="#ErrorAndException">9. Errors and Exceptions</a>
                <ul>
                  <li><a href="#dfn-error-codes">9.1. Throwing an Exception or Returning an Error</a></li>
                </ul></li>
              <li><a href="#url">10. A URL for Blob and File reference</a>
                  <ul>
                    <li><a href="#use-cases-scheme">10.1. Requirements for a New Scheme</a></li>
                    <li><a href="#alternative-schemas">10.2. Discussion of Existing Schemes</a></li>
                    <li><a href="#DefinitionOfScheme">10.3. Definition of blob URL Scheme</a>
                    <ul>
                      <li><a href="#originOfBlobURL">10.3.1. Origin of Blob URLs</a></li>
                      <li><a href="#unicodeSerializationOfBlobURL">10.3.2. Unicode Serialization of a Blob URL</a></li>
                      <li><a href="#fragmentDiscussion">10.3.3. Discussion of Fragment Identifier</a></li>
                    </ul>
                    </li>
                    <li><a href="#requestResponseModel">10.4. Dereferencing Model for Blob URLs</a>
                      <ul>
                        <li><a href="#TwoHundredOK">10.4.1. 200 OK</a></li>
                        <li><a href="#processing-media-types">10.4.2 Processing Media Types</a></li>  
                        <li><a href="#NetworkError">10.4.3. NetworkError Conditions</a></li>
                        <li><a href="#ProtocolExamples">10.4.4. Examples</a></li>
                    </ul>
                    </li>
                    <li><a href="#creating-revoking">10.5. Creating and Revoking a Blob URL</a>
                        <ul>
                          <li><a href="#createRevokeMethodsParams">10.5.1. Methods and Parameters</a></li>
                          <li><a href="#examplesOfCreationRevocation">10.5.2. Examples of Blob URL Creation and Revocation</a></li>
                         </ul>
                         </li>
                    <li><a href="#lifeTime">10.6. Lifetime of Blob URLs</a></li>
                </ul></li>
              <li><a href="#security-discussion">11. Security Considerations</a></li>
              <li><a href="#requirements">12. Requirements and Use Cases</a></li>
              <li><a href="#AppendixA">13. Appendix A</a>
              </li>
              <li><a href="#acknowledgements-section">14. Acknowledgements</a></li>
              <li><a href="#references">15. References</a>
                <ul>
                  <li><a href="#normative-references">15.1. Normative references</a></li>
                  <li><a href="#informative-references">15.2. Informative References</a></li>
                </ul></li>
          </ul>
                  </div>
    </div>

    <div id="sections">
    <div id="introduction" class="section">
    <h2>1. Introduction</h2>

      <p class="norm">This section is informative.</p>

      <p>
      Web applications should have the ability to manipulate as wide
      as possible a range of user input, including files that a user may wish to upload 
      to a remote server or manipulate inside a rich web application. This specification 
      defines the basic representations for files, lists of files, errors raised by access to files,
      and programmatic ways to read files.  Additionally, this specification also defines an interface that represents
      "raw data" which can be asynchronously processed on the main thread of conforming user agents.  The interfaces and API defined in this
      specification can be used with other interfaces and APIs exposed to the web platform.
      
    </p>
    <p>
      The <a href="#dfn-file"><code>File</code></a> interface represents file data typically obtained from the underlying (OS) file system, and the <a href="#dfn-Blob"><code>Blob</code></a> interface
      ("Binary Large Object" - a name originally introduced to web APIs in <a href="#Blob-REF">Google Gears</a>) represents immutable raw data.  <a href="#dfn-file"><code>File</code></a> or
      <a href="#dfn-Blob"><code>Blob</code></a> reads should happen asynchronously on the main thread, with an optional synchronous API used
      within threaded web applications.  An asynchronous API for reading files prevents blocking and UI "freezing" on a user
      agent's main thread.  This specification defines an asynchronous API based on an <em>event model</em> to read and access a <a href="#dfn-file"><code>File</code></a> or <a href="#dfn-Blob"><code>Blob</code></a>'s
      data.  A <a href="#dfn-filereader"><code>FileReader</code></a>
    object provides asynchronous read methods to
    access that file's data through event handler attributes and the firing of events.  The use of events and event handlers allows separate code blocks the ability
    to monitor the <em>progress of the read</em> (which is particularly useful for remote drives or mounted drives, where file access performance may vary from local drives)
    and error conditions that may arise during reading of a file.  An example will be illustrative.</p>
    <div class="example"><div class="exampleHeader">Example</div>
    <p>In the example below, different code blocks handle progress, error, and success conditions.</p>
    <div class="block"><div class="blockTitleDiv"><span class="blockTitle">ECMAScript</span></div><div class="blockContent"><pre class="code"><code class="es-code">
function startRead() {  
  <span class="comment">// obtain input element through DOM</span> 
  
  var file = document.getElementById('file').files[0];
  if(file){
    getAsText(file);
  }
}

function getAsText(readFile) {
        
  var reader = new FileReader();
  
  <span class="comment">// Read file into memory as UTF-16</span>      
  reader.readAsText(readFile, "UTF-16");
  
  <span class="comment">// Handle progress, success, and errors</span>
  reader.onprogress = updateProgress;
  reader.onload = loaded;
  reader.onerror = errorHandler;
}

function updateProgress(evt) {
  if (evt.lengthComputable) {
    <span class="comment">// evt.loaded and evt.total are ProgressEvent properties</span>
    var loaded = (evt.loaded / evt.total);
    if (loaded &lt; 1) {
      <span class="comment">// Increase the prog bar length</span>
      <span class="comment">// style.width = (loaded * 200) + "px";</span>
    }
  }
}

function loaded(evt) {  
  <span class="comment">// Obtain the read file data</span>    
  var fileString = evt.target.result;
  <span class="comment">// Handle UTF-16 file dump</span>
  if(utils.regexp.isChinese(fileString)) {
    <span class="comment">//Chinese Characters + Name validation</span>
  }
  else {
    <span class="comment">// run other charset test</span>
  }
  <span class="comment">// xhr.send(fileString)</span>     
}

function errorHandler(evt) {
  if(evt.target.error.name == "NotReadableError") {
    <span class="comment">// The file could not be read</span>
  }
}
</code></pre></div></div>
</div>

</div>

<div id="conformance" class="section">
        <h2>2. Conformance</h2>

        <p>
          Everything in this specification is normative except for
          examples and sections marked as being informative.
        </p>
        <p>
          The keywords “<span class="rfc2119">MUST</span>”,
          “<span class="rfc2119">MUST NOT</span>”,
          “<span class="rfc2119">REQUIRED</span>”,
          “<span class="rfc2119">SHALL</span>”,
          “<span class="rfc2119">SHALL NOT</span>”,
          “<span class="rfc2119">RECOMMENDED</span>”,
          “<span class="rfc2119">MAY</span>” and
          “<span class="rfc2119">OPTIONAL</span>” in this document are to be
          interpreted as described in
          <cite><a href="http://www.ietf.org/rfc/rfc2119">Key words for use in RFCs to
              Indicate Requirement Levels</a></cite>
          <a href="#RFC2119">[RFC2119]</a>.
        </p>
        <p>
          The following conformance classes are defined by this specification:
        </p>
        <dl>
          <dt><dfn id="dfn-conforming-implementation">conforming user agent</dfn></dt>
          <dd>
            <p>
              A user agent is considered to be a
              <a class="dfnref" href="#dfn-conforming-implementation">conforming user agent</a>
              if it satisfies all of the <span class="rfc2119">MUST</span>-,
              <span class="rfc2119">REQUIRED</span>- and <span class="rfc2119">SHALL</span>-level
              criteria in this specification that apply to implementations.  This specification uses both the terms "conforming user agent" and "user agent" to refer to this product class.
            </p>
	    <p>User agents may implement algorithms in this specifications in any way desired, so long as the end result is indistinguishable from the result that would be obtained
	    from the specification's algorithms.</p>
          </dd>         
        </dl>
	<p>User agents that use ECMAScript to implement the APIs defined in this specification must implement them in a manner consistent with the
	ECMAScript Bindings defined in the Web IDL specification [<a href="#WebIDL">WEBIDL</a>] as this specification uses that specification and terminology. </p>      
      
      </div>
<div id="dependencies" class="section">
      <h3>3. Dependencies</h3>
      <p>This specification relies on underlying specifications.</p>
      <dl><dt>DOM</dt>
      <dd><p>A <a href="#dfn-conforming-implementation">conforming user agent</a> must support at least the subset of the functionality defined in DOM4 that this specification relies upon; in particular,
      it must support <code>EventTarget</code>. [<a href="#DOM4">DOM4</a>] </p></dd>
      <dt>Progress Events</dt>
      <dd><p>A <a href="#dfn-conforming-implementation">conforming user agent</a> must support the Progress Events specification. Data access on read operations is enabled via Progress Events.[<a href="#ProgressEvents">ProgressEvents</a>] </p></dd>
      <dt>HTML</dt>
      <dd><p>A <a href="#dfn-conforming-implementation">conforming user agent</a> must support at least the subset of the functionality defined in HTML that this specification relies upon;
      in particular, it must support <a href="#event-loops">event loops</a> and <a href="#event-handler-attributes">event handler attributes</a>. [<a href="#HTML">HTML</a>]</p></dd>
      <dt>Web IDL</dt>
      <dd><p>A <a href="#dfn-conforming-implementation">conforming user agent</a> must also be a conforming implementation of the IDL fragments in this specification,
      as described in the Web IDL specification. [<a href="#WebIDL">WebIDL</a>] </p></dd>
      <dt>Typed Arrays</dt>
      <dd><p>A <a href="#dfn-conforming-implementation">conforming user agent</a> must support the Typed Arrays specification [<a href="#TypedArrays">TypedArrays</a>].</p></dd></dl>
      <p>Parts of this specification rely on the Web Workers specification; for those parts of this specification, the Web Workers specification is a normative dependency.
      [<a href="#Workers">Workers</a>]</p>
      </div>      
<div id="terminology" class="section">
        <h2>4. Terminology</h2>
        <div id="termsAndAlgos" class="section">
          <h3>4.1 Terms </h3>
        <p>The terms and algorithms <dfn id="document">document</dfn>,
        <dfn id="unloading-document-cleanup-steps">unloading document cleanup steps</dfn>, <dfn id="event-handler-attributes">event handler attributes</dfn>,
        <dfn id="event-handler-event-type">event handler event type</dfn>,
        <dfn id="effectiveScriptOrigin">effective script origin</dfn>, <dfn id="incumbentSettingsObject">incumbent settings object</dfn>, <dfn id="event-loops">event loops</dfn>,
        <dfn id="dfn-task">task</dfn>, <dfn id="task-source">task source</dfn>, <dfn id="df-URL">URL</dfn>, <dfn id="global-script-cleanup-jobs-list">global script cleanup jobs list</dfn>, <dfn id="global-script-cleanup-jobs">global script cleanup</dfn>,
        <dfn id="queue-a-task">queue a task</dfn>, <dfn id="dfn-UTF-8">UTF-8</dfn>, <dfn id="dfn-UTF-16">UTF-16</dfn>. <dfn id="structured-clone">structured clone</dfn>, <dfn id="collect-a-sequence-of-characters">collect a sequence of characters</dfn> and <dfn id="converting-a-string-to-ASCII-lowercase">converting a string to ASCII lowercase</dfn> are as defined by the HTML specification [<a href="#HTML">HTML</a>]. </p>
        <p>The terms <dfn id="origin">origin</dfn> and <dfn id="same-origin">same origin</dfn> are as defined by the Web Origin Concept specification [<a href="#WEBORIGIN">ORIGIN</a>].</p>
 <p>When this specification says to <dfn id="terminate-an-algorithm">terminate an algorithm</dfn> the user agent must terminate the algorithm after finishing the step it is on, and return from it.  Asynchronous <a href="#read-methods">read methods</a> defined in this specification may return before the algorithm in question is terminated, and can be terminated by an <a href="#dfn-abort"><code>abort()</code></a> call.</p>
<p>The term <dfn id="throw-an-exception">throw</dfn> in this specification, as it pertains to exceptions, is used as defined in the DOM4 specification [<a href="#DOM4">DOM4</a>].</p>
<p>The term <dfn id="byte">byte</dfn> in this specification is used as defined in the Encoding Specification [<a href="#encodingSpecification">Encoding Specification</a>].</p>
<p>The term <dfn id="chunk">chunk</dfn> in this specification is used as defined in the Streams Specification [<a href="#streamsSpecification">Streams Specification</a>.]</p>
<p>The term <dfn id="contextObject">context object</dfn> in this specification is used as defined in the DOM4 specification [<a href="#DOM4">DOM4</a>].</p>
<p>The terms <dfn id="URL">URL</dfn>, <dfn id="relativeURL">relative URL</dfn>, <dfn id="baseURL">base URL</dfn>, <dfn id="URLParser">URL parser</dfn>, <dfn id="basicURLParser">basic URL Parser</dfn>, <dfn id="scheme">scheme</dfn>, <dfn id="host">host</dfn>, <dfn id="relativeScheme">relative scheme</dfn>, <dfn id="scheme-data">scheme data</dfn>, and <dfn id="fragmentIDDef">fragment</dfn> are as defined by the WHATWG URL Specification [<a href="#URL-API">URL</a>].</p>
<p>The terms <dfn id="requestFetch">request</dfn>, <dfn id="responseFetch">response</dfn>, <dfn id="dfn-body">body</dfn> and <dfn id="cross-origin-request">cross-origin request</dfn> are as defined in the WHATWG Fetch Specification [<a href="#Fetch">Fetch Specification</a>].</p>
<p>The term <dfn id="UnixEpoch">Unix Epoch</dfn> is used in this specification to refer to the time 00:00:00 UTC on January 1 1970 (or 1970-01-01T00:00:00Z ISO 8601); this is the same time that is conceptually "0" in ECMA-262 [<a href="#ECMA-262">ECMA-262</a>].</p> 
       <p>The algorithms and steps in this specification use the following mathematical operations:</p>
       <ul>
       <li><p>max(a,b) returns the maximum of a and b, and is always performed on integers as they are defined in WebIDL [<a href="#WebIDL">WebIDL</a>]; in the case of max(6,4) the result is 6.
       This operation is also defined in ECMAScript [<a href="#ECMA-262">ECMA-262</a>].</p></li>
       <li><p>min(a,b) returns the minimum of a and b, and is always performed on integers as they are defined in WebIDL [<a href="#WebIDL">WebIDL</a>]; in the case of min(6,4) the result is 4.
       This operation is also defined in ECMAScript [<a href="#ECMA-262">ECMA-262</a>].</p></li>
       <li><p>Mathematical comparisons such as &lt; (less than), ≤ (less than or equal to) and &gt; (greater than)  are as in ECMAScript
       [<a href="#ECMA-262">ECMA-262</a>].</p></li>
       </ul>
  </div>     
 
     
</div>
      
<div id="blob" class="section">
    <h2>5. The Blob Interface and Binary Data</h2>
    <p>
      A <a href="#dfn-Blob"><code>Blob</code></a> object refers to a <a href="#byte">byte</a> sequence, and has a <a href="#dfn-size"><code>size</code></a> attribute which is the total number of bytes in the byte sequence, and a <a href="#dfn-type"><code>type</code></a> attribute, which is an ASCII-encoded string in lower case representing the media type of the <a href="#byte">byte</a> sequence.   
    </p>
    <p>A <a href="#dfn-Blob"><code>Blob</code></a> must have a <dfn id="readabilityState">readability state</dfn>, which is one of <a href="#dfn-openState"><code>OPENED</code></a> or <a href="#dfn-closedState"><code>CLOSED</code></a>. A <a href="#dfn-Blob"><code>Blob</code></a> that refers to a <a href="#byte">byte</a> sequence, including one of 0 bytes, is said to be in the <dfn id="dfn-openState"><code>OPENED</code></dfn> <a href="#readabilityState">readability state</a>. A <a href="#dfn-Blob"><code>Blob</code></a> is said to be <dfn id="closed">closed</dfn> if its <a href="#dfn-close"><code>close</code></a> method has been called. A <a href="#dfn-Blob"><code>Blob</code></a> that is <a href="#closed">closed</a> is said to be in the <dfn id="dfn-closedState"><code>CLOSED</code></dfn> <a href="#readabilityState">readability state</a>.</p>
    <p>Each <a href="#dfn-Blob"><code>Blob</code></a> must have an internal <dfn id="snapshot-state">snapshot state</dfn>, which must be initially set to the state of the underlying storage, if any such underlying storage exists, and must be preserved through <a href="#structured-clone">structured clone</a>.  Further normative definition of <a href="#snapshot-state">snapshot state</a> can be found for <a href="#file">files</a>. </p>
    <div class="block"><div class="blockTitleDiv"><span class="blockTitle">IDL</span></div><div class="blockContent"><pre class="code"><code class="idl-code">
    <dfn id="dfn-Blob">[Constructor, 
     Constructor(sequence&lt;(ArrayBuffer or ArrayBufferView or Blob or DOMString)&gt; <a href="#dfn-blobParts" title="blobParts" class="dfnref">blobParts</a>, optional <a href="#dfn-BlobPropertyBag" title="BlobPropertyBag" class="dfnref">BlobPropertyBag</a> options), Exposed=Window,Worker] 
    interface Blob</dfn> {
      
      readonly attribute unsigned long long <a href="#dfn-size" title="size" class="dfnref">size</a>;
      readonly attribute DOMString <a href="#dfn-type" class="dfnref">type</a>;
      readonly attribute boolean <a href="#dfn-isClosed" class="dfnref">isClosed</a>;
      
      <span class="comment">//slice Blob into byte-ranged chunks</span>
      
      Blob <a href="#dfn-slice" title="slice">slice</a>([Clamp] optional long long <a href="#dfn-start" class="dfnref" title="start">start</a>,
                 [Clamp] optional long long <a href="#dfn-end" class="dfnref" title="length">end</a>,
                 optional DOMString <a href="#dfn-contentTypeBlob">contentType</a>);
      void <a href="#dfn-close" title="close">close</a>(); 
    
    };

    dictionary <dfn id="dfn-BlobPropertyBag">BlobPropertyBag</dfn> {
		
      DOMString <a href="#dfn-BPtype" title="BPtype">type</a> = "";
	
    };
    </code></pre></div></div>
    <div id="constructorBlob" class="section">
		<h3>5.1. Constructors</h3>
		<p>The <code>Blob()</code> constructor can be invoked with zero or more parameters.  When the <code>Blob()</code> constructor is invoked, user agents must run the following <dfn id="blob-constructor-steps">Blob constructor steps</dfn>:</p>
    <ol>
      <li><p>If invoked with zero parameters, return a new <code>Blob</code> object with its <a href="#readabilityState">readability state</a> set to <a href="#dfn-openState"><code>OPENED</code></a>, consisting of 0 bytes, with <a href="#dfn-size"><code>size</code></a> set to 0, and with <a href="#dfn-type"><code>type</code></a> set to the empty string.</p></li>
      <li><p>Otherwise, the constructor is invoked with a <a href="#dfn-blobParts"><code>blobParts</code></a> sequence.  Let <var>a</var> be that sequence.</p></li>
     <li><p>Let <var>bytes</var> be an empty sequence of bytes.</p></li>
      <li><p>Let <var>length</var> be <var>a</var>'s length.  For 0 ≤ <var>i</var> &lt; <var>length</var>, repeat the following steps:</p>
      <ol>
        <li><p>Let <var>element</var> be the <var>i</var>th element of <var>a</var>.</p></li>
        <li><p>If <var>element</var> is a <code>DOMString</code>, run the following substeps:</p>
        <ol>
          <li><p>Let <var>s</var> be the result of converting <var>element</var> to a sequence of Unicode characters [<a href="#Unicode">Unicode</a>] using the algorithm for doing so in WebIDL [<a href="#WebIDL">WebIDL</a>].</p></li>
         
         <li><p>Encode <var>s</var> as <a href="#dfn-UTF-8" class="dfnrefs">UTF-8</a> and append the resulting bytes to <var>bytes</var>.</p></li>
       </ol>
       <div class="note"><div class="noteHeader">Note</div>
         <p>The algorithm from WebIDL [<a href="#WebIDL">WebIDL</a>] replaces unmatched surrogates in an invalid <a href="#dfn-UTF-16" class="dfnrefs">UTF-16</a> string with U+FFFD replacement characters. Scenarios exist when the <a href="#dfn-Blob"><code>Blob</code></a> constructor may result in some data loss due to lost or scrambled character sequences. </p>
       </div>
     </li>
     <li><p>If <var>element</var> is an <code>ArrayBufferView</code> [<a href="#TypedArrays">TypedArrays</a>], convert it to a sequence of <code>byteLength</code> bytes from the underlying <code>ArrayBuffer</code>, starting at the <code>byteOffset</code> of the <code>ArrayBufferView</code> [<a href="#TypedArrays">TypedArrays</a>], and append those bytes to <var>bytes</var>.</p></li>
     <li><p>If <var>element</var> is an <code>ArrayBuffer</code> [<a href="#TypedArrays">TypedArrays</a>], convert it to a sequence of <code>byteLength</code> bytes, and append those bytes to <var>bytes</var>.</p></li>
     <li><p>If <var>element</var> is a <code>Blob</code>, append the bytes it represents to <var>bytes</var>.  The <a href="#dfn-type"><code>type</code></a> of the <code>Blob</code> array element is ignored.</p></li>
    </ol>
  </li>
  <li><p>If the <a href="#dfn-BPtype"><code>type</code></a> member of the optional <code>options</code> argument is provided and is not the empty string, run the following sub-steps:</p>
    <ol>
      <li>Let <var>t</var> be the <a href="#dfn-BPtype"><code>type</code></a> dictionary member. If <var>t</var> contains any characters outside the range U+0020 to U+007E, then set <var>t</var> to the empty string and return from these substeps.</li>
      <li>Convert every character in <var>t</var> to lowercase using the "<a href="#converting-a-string-to-ASCII-lowercase">converting a string to ASCII lowercase</a>" algorithm [<a href="#WebIDL">WebIDL</a>].</li>

    </ol>

  </li>

<li><p>Return a <code>Blob</code> object with its <a href="#readabilityState">readability state</a> set to <a href="#dfn-openState"><code>OPENED</code></a>, referring to <var>bytes</var> as its associated <a href="#byte">byte</a> sequence, with its <a href="#dfn-size"><code>size</code></a> set to the length of <var>bytes</var>, and its <a href="#dfn-type"><code>type</code></a> set to the value of <var>t</var> from the substeps above.  </p>
<div class="note"><div class="noteHeader">Note</div><p>The type t of a <code>Blob</code> is considered a <em>parsable MIME type</em> if the ASCII-encoded string representing the Blob object's type, when converted to a byte sequence, does not return undefined for the <em>parse MIME type algorithm</em> [<a href="#MIMESNIFF">MIMESNIFF</a>].</p> </div>
</li>
</ol>


		<div id="constructorParams" class="section">
		<h4>5.1.1. Constructor Parameters</h4>
		<p>The <code>Blob()</code> constructor can be invoked with the parameters below:</p>
		<dl>
			<dt id="dfn-blobParts">A <code>blobParts</code> <code>sequence</code></dt> 
			<dd>which takes any number of the following types of elements, and in any order:
				<ul>
        <li><p><code>ArrayBuffer</code> [<a href="#TypedArrays">TypedArrays</a>] elements.</p></li>
				<li><p><code>ArrayBufferView</code> [<a href="#TypedArrays">TypedArrays</a>] elements.</p></li>
				<li><p><a href="#dfn-Blob"><code>Blob</code></a> elements.</p></li>
				<li><p><code>DOMString</code> [<a href="#WebIDL">WebIDL</a>] elements.</p></li>
				</ul>		
			</dd>
			<dt>An <em>optional</em> <a href="#dfn-BlobPropertyBag"><code>BlobPropertyBag</code></a></dt>
			<dd>which takes one member:
			<ul>
				<li><dfn id="dfn-BPtype"><code>type</code></dfn>, the ASCII-encoded string in lower case representing the media type of the <code>Blob</code>.  Normative conditions for this member are provided in the <a href="#blob-constructor-steps">Blob constructor steps.</a></li>
			</ul>
		</dd>
		</dl>
	</div>
<div class="example"><div class="exampleHeader">Example</div>
<p>Examples of constructor usage follow.</p>
<div class="block"><div class="blockTitleDiv"><span class="blockTitle">ECMAScript</span></div><div class="blockContent"><pre class="code"><code class="es-code">
<span class="comment">// Create a new Blob object</span>

var a = new Blob();

<span class="comment">// Create a 1024-byte ArrayBuffer</span>
<span class="comment">// buffer could also come from reading a File</span>

var buffer = new ArrayBuffer(1024);

<span class="comment">// Create ArrayBufferView objects based on buffer</span>

var shorts = new Uint16Array(buffer, 512, 128);
var bytes = new Uint8Array(buffer, shorts.byteOffset + shorts.byteLength);

var b = new Blob(["foobarbazetcetc" + "birdiebirdieboo"], {type: "text/plain;charset=UTF-8"});

var c = new Blob([b, shorts]);

var a = new Blob([b, c, bytes]);

var d = new Blob([buffer, b, c, bytes]);

</code></pre></div></div>

</div>				
	</div>        
    <div id="attributes-blob" class="section">
    <h3>5.2. Attributes</h3>
    <dl><dt id="dfn-size"><code>size</code></dt><dd><p>Returns the size of the <a href="#byte">byte</a> sequence in number of bytes.  On getting, conforming user agents must return the total
    number of bytes that can be read by a <a href="#dfn-filereader"><code>FileReader</code></a> or <a href="#dfn-FileReaderSync"><code>FileReaderSync</code></a> object, or 0 if the Blob has no bytes to be read.  If the <code>Blob</code> has a readability state of <a href="#dfn-closedState"><code>CLOSED</code></a> then <code>size</code> must return 0.</p></dd>
    <dt id="dfn-type"><code>type</code></dt>
    <dd><p>The ASCII-encoded string in lower case representing the media type of the <code>Blob</code>. On getting, user agents must return the type of a <code>Blob</code> as an ASCII-encoded string in lower case, such that when it is converted to a <a href="#byte">byte</a> sequence, it is a <em>parsable MIME type</em> [<a href="#MIMESNIFF">MIMESNIFF</a>], or the empty string -- 0 bytes -- if the type cannot be determined. The <a href="#dfn-type"><code>type</code></a> attribute can be set by the web application itself through constructor invocation and through the <a href="#dfn-slice"><code>slice</code></a> call; in these cases, further normative conditions for this attribute are in the <a href="#blob-constructor-steps">Blob constructor steps</a>, the <a href="#file-constructor-steps">File Constructor steps</a>, and the <a href="#slice-method-algo">slice method algorithm</a> respectively. User agents can also determine the <a href="#dfn-type"><code>type</code></a> of a <a href="#dfn-Blob"><code>Blob</code></a>, especially if the <a href="#byte">byte</a> sequence is from an on-disk file; in this case, further normative conditions are in the <a href="#file-type-guidelines">file type guidelines.</a>.  
    </p></dd>
    <dt id="dfn-isClosed"><code>isClosed</code></dt>
    <dd><p>The boolean value that indicates whether the <code>Blob</code> is in the <a href="#dfn-closedState"><code>CLOSED</code></a> <a href="#readabilityState">readability state.</a> On getting, user agents must return <code>false</code> if the <code>Blob</code> is in the <a href="#dfn-openState"><code>OPENED</code></a> <a href="#readabilityState">readability state</a>, and <code>true</code> if the <code>Blob</code> is in the <a href="#dfn-closedState"><code>CLOSED</code></a> <a href="#readabilityState">readability state</a> as a result of the <a href="#dfn-close"><code>close</code></a> method being called.</p></dd>
    </dl>
    <div class="note"><div class="noteHeader">Note</div>
<p>Use of the <code>type</code> attribute informs the <a href="#encoding-determination">encoding determination</a> and <a href="#processing-media-types">parsing the Content-Type header</a> when <a href="#dereference">dereferencing</a> <a href="#DefinitionOfScheme">Blob URLs</a>.</p>
    </div>
    </div>
    <div id="methodsandparams-blob" class="section">
    <h3>5.3. Methods and Parameters</h3>
    
<div class="section" id="slice-method-algo">
<h4>5.3.1. The slice method</h4>	
    <p>The <dfn id="dfn-slice"><code>slice</code></dfn> method returns a new <a href="#dfn-Blob" class="dfnref"><code>Blob</code></a> object with bytes ranging from the optional <a href="#dfn-start"><code>start</code></a>
	parameter upto but not including the optional <a href="#dfn-end"><code>end</code></a> parameter, and with a
	<a href="#dfn-type" class="dfnref"><code>type</code></a> attribute that is the value of the optional <a href="#dfn-contentTypeBlob"><code>contentType</code></a> parameter.  It must act as follows :</p>
    <ol>
    <li><p>Let <var>O</var> be the <a href="#dfn-Blob"><code>Blob</code></a> <a href="#contextObject">context object</a> on which the <code>slice</code> method is being called. </p></li>
    <li><p>The optional <dfn id="dfn-start"><code>start</code></dfn> parameter is a value for the start point of a <a href="#dfn-slice" class="dfnref"><code>slice</code></a> call, and must be treated as a byte-order position, with the zeroth position representing the first byte.
    User agents must process <a href="#dfn-slice"><code>slice</code></a> with
    <code>start</code> <em>normalized</em> according to the following:</p>
    <ol type="a">
    <li><p>If the optional <code>start</code> parameter is not used as a parameter when making this call, let <var>relativeStart</var> be 0.</p></li>
    <li><p>If <code>start</code> is negative, let <var>relativeStart</var> be <em>max((<a href="#dfn-size"><code>size</code></a> + <code>start</code>), 0)</em>.</p></li>
    <li><p>Else, let <var>relativeStart</var> be <em>min(start, size)</em>.</p></li>
    </ol> 
  </li>
  <li><p>The optional <dfn id="dfn-end"><code>end</code></dfn> parameter is a value for the end point of a
    <a href="#dfn-slice" class="dfnref"><code>slice</code></a> call.  User agents must process <a href="#dfn-slice"><code>slice</code></a> with <code>end</code> normalized according to the following:</p>
    <ol type="a">
    <li><p>If the optional <code>end</code> parameter is not used as a parameter when making this call, let <var>relativeEnd</var> be <a href="#dfn-size"><code>size</code></a>.</p></li>
    <li><p>If <code>end</code> is negative, let <var>relativeEnd</var> be <em>max((size + end), 0)</em> </p></li>
    <li><p>Else, let <var>relativeEnd</var> be <em>min(end, size)</em></p></li>
    </ol>
  </li>
  <li><p>The optional <dfn id="dfn-contentTypeBlob"><code>contentType</code></dfn> parameter is used to set the ASCII-encoded string in lower case representing the media type of the Blob.  User agents must process the <a href="#dfn-slice"><code>slice</code></a> with <code>contentType</code> normalized according to the following:
   </p>
   <ol type="A">
   <li><p>If the <code>contentType</code> parameter is not provided, let <var>relativeContentType</var> be set to the empty string .</p></li>
   <li><p>Else let <var>relativeContentType</var> be set to <code>contentType</code> and run the substeps below: </p>
    <ol>
      <li>If <var>relativeContentType</var> contains any characters outside the range of U+0020 to U+007E, then set <var>relativeContentType</var> to the empty string and return from these substeps.</li>
      <li>Convert every character in <var>relativeContentType</var> to lower case using the "<a href="#converting-a-string-to-ASCII-lowercase">Converting a string to ASCII lowercase</a>" algorithm.</li>
    </ol>
 </li>

   </ol>
</li>
    <li><p>Let <var>span</var> be <em>max((relativeEnd - relativeStart), 0)</em>.</p></li>
    <li><p>Return a new <a href="#dfn-Blob"><code>Blob</code></a> object <var>S</var> with the following characteristics:</p>
    <ol type="a">
    <li><p><var>S</var> has a <a href="#readabilityState">readability state</a> equal to that of <var>O</var>'s <a href="#readabilityState">readability state</a>.</p>
     <div class="note"><div class="noteHeader">Note</div><p>The <a href="#readabilityState">readability state</a> of the <a href="#contextObject">context object</a> is retained by the <a href="#dfn-Blob"><code>Blob</code></a> object returned by the <a href="#dfn-slice"><code>slice</code></a> call; this has implications on whether the returned 
     <a href="#dfn-Blob"><code>Blob</code></a> is actually usable for <a href="#readOperation">read operation</a>s or as a <a href="#DefinitionOfScheme">Blob URL</a>.</p></div> 
    </li>  
    <li><p><var>S</var> refers to <var>span</var> consecutive <a href="#byte">byte</a>s from <var>O</var>, beginning with the <a href="#byte">byte</a> at byte-order position <var>relativeStart</var>.</p></li>
    <li><p><var>S</var>.<a href="#dfn-size"><code>size</code></a> = <var>span</var>.</p></li>
    <li><p><var>S</var>.<a href="#dfn-type"><code>type</code></a> = <var>relativeContentType</var>.</p>
      <div class="note"><div class="noteHeader">Note</div><p>The type t of a <code>Blob</code> is considered a <em>parsable MIME type</em> if the ASCII-encoded string representing the Blob object's type, when converted to a byte sequence, does not return undefined for the <em>parse MIME type algorithm</em> [<a href="#MIMESNIFF">MIMESNIFF</a>].</p> </div>
    </li>
    </ol>
    </li>
    </ol>
    <div class="example"><div class="exampleHeader">Example</div>
    <p>
    The examples below illustrate the different types of <a href="#dfn-slice" class="dfnref"><code>slice</code></a> calls possible. Since the
    <a href="#dfn-file"><code>File</code></a> interface inherits from the <a href="#dfn-Blob"><code>Blob</code></a> interface, examples are based on the use of the <a href="#dfn-file"><code>File</code></a> interface.
    </p>
    <div class="block"><div class="blockTitleDiv"><span class="blockTitle">ECMAScript</span></div><div class="blockContent"><pre class="code"><code class="es-code">
    <span class="comment">// obtain input element through DOM</span>
    
    var file = document.getElementById('file').files[0];
    if(file)
    {
      <span class="comment">// create an identical copy of file</span>
      <span class="comment">// the two calls below are equivalent</span>
      
      var fileClone = file.slice(); 
      var fileClone2 = file.slice(0, file.size);
      
      <span class="comment">// slice file into 1/2 chunk starting at middle of file</span>
      <span class="comment">// Note the use of negative number</span>
      
      var fileChunkFromEnd = file.slice(-(Math.round(file.size/2)));
      
      <span class="comment">// slice file into 1/2 chunk starting at beginning of file</span>
      
      var fileChunkFromStart = file.slice(0, Math.round(file.size/2));
      
      <span class="comment">// slice file from beginning till 150 bytes before end</span>
      
      var fileNoMetadata = file.slice(0, -150, "application/experimental");      
    }
    </code></pre></div></div>
    </div>    
</div>
<div id="close-method" class="section">
<h4>5.3.2. The close method</h4>
<p>The <dfn id="dfn-close"><code>close</code></dfn> method is said to <a href="#closed">close</a> a <a href="#dfn-Blob"><code>Blob</code></a>, and must act as follows on the <a href="#dfn-Blob"><code>Blob</code></a> on which the method has been called:</p>
<ol>
  <li><p>If the <a href="#readabilityState">readability state</a> of the <a href="#contextObject">context object</a> is <a href="#dfn-closedState"><code>CLOSED</code></a>, <a href="#terminate-an-algorithm">terminate this algorithm</a>.</p></li>
  <li><p>Otherwise, set the <a href="#readabilityState">readability state</a> of the <a href="#contextObject">context object</a> to <a href="#dfn-closedState"><code>CLOSED</code></a>.</p></li> 
  <li><p>If the <a href="#contextObject">context object</a> has an entry in the <a href="#BlobURLStore">Blob URL Store</a>, <a href="#removeTheEntry">remove the entry</a> that corresponds to the <a href="#contextObject">context object</a>.</p></li>
</ol>

</div>
  </div>
  
    </div>
	<div id="file" class="section">
	  <h2>6. The File Interface</h2>
	  <p>
	    A <a href="#dfn-file"><code>File</code></a> object is a <a href="#dfn-Blob"><code>Blob</code></a> object with a <a href="#dfn-name"><code>name</code></a> attribute, which is a string; it can be created within the web application via a constructor, or is a reference to a <a href="#byte">byte</a> sequence from a file from the underlying (OS) file system.
	  </p>
    <p>If a <a href="#dfn-file"><code>File</code></a> object is a reference to a <a href="#byte">byte</a> sequence originating from a file on disk, then its <a href="#snapshot-state">snapshot state</a> should be set to the state of the file on disk at the time the <a href="#dfn-file"><code>File</code></a> object is created. </p>
    <div class="note"><div class="noteHeader">Note</div>
         <p>This is a non-trivial requirement to implement for user agents, and is thus not a <em>must</em> but a <em>should</em> [<a href="#RFC2119">RFC2119</a>].  User agents should endeavor to have a <a href="#dfn-file"><code>File</code></a> object's <a href="#snapshot-state">snapshot state</a> set to the state of the underlying storage on disk at the time the reference is taken. If the file is modified on disk following the time a reference has been taken, the <a href="#dfn-file"><code>File</code></a>'s <a href="#snapshot-state">snapshot state</a> will differ from the state of the underlying storage.  User agents may use modification time stamps and other mechanisms to maintain <a href="#snapshot-state">snapshot state</a>, but this is left as an implementation detail.</p>
       </div>
<p>When a <a href="#dfn-file"><code>File</code></a> object refers to a file on disk, user agents must return the <a href="#dfn-type"><code>type</code></a> of that file, and must follow the <dfn id="file-type-guidelines">file type guidelines</dfn> below:</p>
<ul>
<li><p>User agents must return the <a href="#dfn-type"><code>type</code></a> as an ASCII-encoded string in lower case, such that when it is converted to a corresponding byte sequence, it is a <em>parsable MIME type</em> [<a href="#MIMESNIFF">MIMESNIFF</a>], or the empty string -- 0 bytes -- if the type cannot be determined.</p> </li>
<li><p>When the file is of type <code>text/plain</code> user agents must NOT append a charset parameter to the <em>dictionary of parameters</em> portion of the media type 
[<a href="#MIMESNIFF">MIMESNIFF</a>]. </p></li>
<li><p>User agents must not attempt heuristic determination of encoding, including statistical methods. </p></li>
</ul>

<div class="block"><div class="blockTitleDiv"><span class="blockTitle">IDL</span></div><div class="blockContent"><pre class="code"><code class="idl-code">
<dfn id="dfn-file">[Constructor(sequence&lt;(Blob or DOMString or ArrayBufferView or ArrayBuffer)&gt; <a href="#dfn-fileBits" class="dfnrefs">fileBits</a>, 
[EnsureUTF16] DOMString <a href="#dfn-fileName" class="dfnrefs">fileName</a>, optional FilePropertyBag options), Exposed=Window,Worker]
interface File</dfn> : <a href="#dfn-Blob" class="dfnref">Blob</a> {

  readonly attribute DOMString <a href="#dfn-name" class="dfnref">name</a>;
  readonly attribute long long <a href="#dfn-lastModified" class="dfnref">lastModified</a>;

};

dictionary <dfn id="dfn-FilePropertyBag">FilePropertyBag</dfn> {
    
      DOMString <a href="#dfn-FPtype" title="FPtype">type</a> = "";
      long long <a href="#dfn-FPdate" title="FPdate">lastModified</a>;
  
};
	  </code></pre></div></div>
    <div id="file-constructor" class="section">
      <h3>6.1 Constructor</h3>
    <p>The <code>File</code> constructor is invoked with two or three parameters, depending on whether the optional dictionary parameter is used.  When the <code>File()</code> constructor is invoked, user agents must run the following <dfn id="file-constructor-steps">File constructor steps</dfn>:</p>
    <ol>
    <li>Let <var>a</var> be the <code><a href="#dfn-fileBits">fileBits</a></code> sequence argument.  Let <var>bytes</var> be an empty sequence of <a href="#byte">bytes</a>.  Let <var>length</var> be <var>a</var>'s length.  For 0 ≤ i &lt; <var>length</var>, repeat the following steps:
    <ol>
      <li>Let <var>element</var> be the <var>i</var>'th element of <var>a</var>.</li>
      <li>If <var>element</var> is a <code>DOMString</code>, run the following substeps:
       <ol>
          <li><p>Let <var>s</var> be the result of converting <var>element</var> to a sequence of Unicode characters [<a href="#Unicode">Unicode</a>] using the algorithm for doing so in WebIDL [<a href="#WebIDL">WebIDL</a>].</p></li>
         
         <li><p>Encode <var>s</var> as <a href="#dfn-UTF-8" class="dfnrefs">UTF-8</a> and append the resulting <a href="#byte">bytes</a> to <var>bytes</var>.</p></li>
       </ol>
       <div class="note"><div class="noteHeader">Note</div>
         <p>The algorithm from WebIDL [<a href="#WebIDL">WebIDL</a>] replaces unmatched surrogates in an invalid <a href="#dfn-UTF-16" class="dfnrefs">UTF-16</a> string with U+FFFD replacement characters. Scenarios exist when the <a id="dfnReturnLink-10" href="#dfn-Blob"><code>Blob</code></a> constructor may result in some data loss due to lost or scrambled character sequences. </p>
       </div></li>
       <li>If <var>element</var> is an <code>ArrayBufferView</code> [<a href="#TypedArrays">TypedArrays</a>], convert it to a sequence of <code>byteLength</code> bytes from the underlying ArrayBuffer, starting at the <code>byteOffset</code> of the <code>ArrayBufferView</code> [<a href="#TypedArrays">TypedArrays</a>], and append those bytes to <var>bytes</var>.</li>
       <li><p>If <var>element</var> is an <code>ArrayBuffer</code> [<a href="#TypedArrays">TypedArrays</a>], convert it to a sequence of <code>byteLength</code> bytes, and append those bytes to <var>bytes</var>.</p></li>
     <li><p>If <var>element</var> is a <code>Blob</code>, append the bytes it represents to <var>bytes</var>.  The <a href="#dfn-type"><code>type</code></a> of the <code>Blob</code> argument must be ignored.</p></li>
    </ol>
     </li>
     <li>Let <var>n</var> be a new string of the same size as the <code><a href="#dfn-fileName">fileName</a></code> argument to the constructor. Copy every character from <code><a href="#dfn-fileName">fileName</a></code> to <var>n</var>, replacing any "/" character (U+002F SOLIDUS) with a ":" (U+003A COLON).
    <div class="note"><div class="noteHeader">Note</div>
         <p>Underlying OS filesystems use differing conventions for file name; with constructed files, mandating UTF-16 lessens ambiquity when file names are converted to <a href="#byte">byte</a> sequences.</p>
       </div>


     </li>
     <li>If the optional <a href="#dfn-FilePropertyBag"><code>FilePropertyBag</code></a> dictionary argument is used, then run the following substeps:
      <ol>
        <li>If the <a href="#dfn-FPtype"><code>type</code></a> member is provided and is not the empty string, let <var>t</var> be set to the <a href="#dfn-FPtype"><code>type</code></a> dictionary member.  If <var>t</var> contains any characters outside the range U+0020 to U+007E, then set <var>t</var> to the empty string and return from these substeps. </li>
        <li>Convert every character in <var>t</var> to lowercase using the "<a href="#converting-a-string-to-ASCII-lowercase">converting a string to ASCII lowercase algorithm</a>" [<a href="#WebIDL">WebIDL</a>].</li>
        <li>If the <a href="#dfn-FPdate"><code>lastModified</code></a> member is provided, let <var>d</var> be set to the  <a href="#dfn-FPdate"><code>lastModified</code></a> dictionary member.  If it is not provided, set <var>d</var> to the current date and time represented as the number of milliseconds since the <a href="#UnixEpoch">Unix Epoch</a> (which is the equivalent of <code>Date.now()</code> [<a href="#ECMA-262">ECMA-262</a>]).
        <div class="note"><div class="noteHeader">Note</div><p>Since ECMA-262 <code>Date</code> objects convert to <code>long long</code> values representing the number of milliseconds since the <a href="#UnixEpoch">Unix Epoch</a>, the <a href="#dfn-FPdate"><code>lastModified</code></a> member could be a <code>Date</code> object [<a href="#ECMA-262">ECMA-262</a>].</p></div> 
        </li>
      </ol>
    </li>
    <li>Return a new <code>File</code> object <var>F</var> such that:
      <ol>
        <li><var>F</var> has a <a href="#readabilityState">readability state</a> of <a href="#dfn-openState"><code>OPENED</code></a>.</li> 
        <li><var>F</var> refers to the <var>bytes</var> <a href="#byte">byte</a> sequence.</li> 
        <li><code>F.size</code> is set to the number of total bytes in <var>bytes</var>.</li>
        <li><code>F.name</code> is set to <var>n</var>.</li>
        <li><code>F.type</code> is set to <var>t</var>.
<div class="note"><div class="noteHeader">Note</div><p>The type t of a <code>File</code> is considered a <em>parsable MIME type</em> if the ASCII-encoded string representing the File object's type, when converted to a byte sequence, does not return undefined for the <em>parse MIME type algorithm</em> [<a href="#MIMESNIFF">MIMESNIFF</a>].</p> </div>
        </li>
        <li><code>F.lastModified</code> is set to <var>d</var>.</li>

      </ol>
    </li>

    </ol>
    <div id="file-constructor-params">
      <h4>6.1.1 Constructor Parameters</h4>
      <p>The <code>File()</code> constructor can be invoked with the parameters below:</p>
      <dl>
        <dt id="dfn-fileBits">A <code>fileBits</code> <code>sequence</code></dt>
        <dd>which takes any number of the following elements, and in any order:
          <ul>
            <li><p><code>ArrayBuffer</code> [<a href="#TypedArrays">TypedArrays</a>] elements.</p></li>
            <li><p><code>ArrayBufferView</code> [<a href="#TypedArrays">TypedArrays</a>] elements.</p></li>
            <li><p><a href="#dfn-Blob"><code>Blob</code></a> elements, which includes <a href="#dfn-file"><code>File</code></a> elements.</p></li>
            <li><p><code>DOMString</code> [<a href="#WebIDL">WebIDL</a>] elements.</p></li>
          </ul>
        </dd>
        <dt id="dfn-fileName">A <code>name</code> parameter</dt>
        <dd>
    <p>A <code>DOMString</code> [<a href="#WebIDL">WebIDL</a>] parameter representing the name of the file; normative conditions for this constructor parameter can be found in the <a href="#file-constructor-steps">File constructor steps</a>.</p></dd>
    <dt id="def-Properties">An optional <a href="#dfn-FilePropertyBag"><code>FilePropertyBag</code></a> dictionary</dt><dd><p>which takes the following members:</p>
    <ul>
      <li><p>An optional <dfn id="dfn-FPtype"><code>type</code></dfn> member; the ASCII-encoded string in lower case representing the media type of the <code>File</code>. Normative conditions for this member are provided in the <a href="#file-constructor-steps">File constructor steps</a>.</p></li>
      <li><p>An optional <dfn id="dfn-FPdate"><code>lastModified</code></dfn> member, which must be a <code>long long</code>; normative conditions for this member are provided in the <a href="#file-constructor-steps">File constructor steps</a>.</p></li>
    </ul>
  </dd>

      </dl>
    </div>

  
    </div>
	  <div id="file-attrs" class="section">
	  <h3>6.2. Attributes</h3>
	  <dl>
	    <dt id="dfn-name"><code>name</code></dt>
	    <dd><p>The name of the file; on getting, this must return the name of the file as a string. There are numerous file name variations and conventions used by different underlying OS file systems;
	    this is merely the name of the file, without path information.  On getting, if user agents cannot make this information available, they must return the empty string.  If a <a href="#dfn-file"><code>File</code></a> object is created using a constructor, further normative conditions for this attribute are found in the <a href="#file-constructor-steps">file constructor steps</a>.</p>
    </dd>
	    <dt id="dfn-lastModified"><code>lastModified</code></dt>
	    <dd><p>The last modified date of the file.  On getting, if user agents can make this information available, this must return a <code>long long</code> set to the time the file was last modified as the number of milliseconds since the <a href="#UnixEpoch">Unix Epoch</a>.  If the last modification date and time are not known, the attribute must return the current date and time as a <code>long long</code> representing the number of milliseconds since the <a href="#UnixEpoch">Unix Epoch</a>; this is equivalent to <code>Date.now()</code> [<a href="#ECMA-262">ECMA-262</a>]. If a <a href="#dfn-file"><code>File</code></a> object is created using a constructor, further normative conditions for this attribute are found in the <a href="#file-constructor-steps">file constructor steps</a>.
	</p></dd>

	    </dl>
	  </div>

	  <p>The <code>File</code> interface is available on objects that expose an attribute of type <a href="#dfn-filelist"><code>FileList</code></a>; these objects are defined in
	  HTML [<a href="#HTML">HTML</a>].  The <code>File</code> interface, which inherits from <a href="#dfn-Blob"><code>Blob</code></a>, is immutable, and thus represents file data that can be
	  read into memory at the time a <a href="#read-methods">read operation</a> is initiated.  User agents must process reads on files that no longer exist at the time of read as
	  <a href="#file-error-read">errors</a>, throwing a <a href="#dfn-NotFoundError"><code>NotFoundError</code></a> exception if using a <a href="#dfn-FileReaderSync"><code>FileReaderSync</code></a> on a Web Worker [<a href="#Workers">Workers</a>] or firing an <a href="#dfn-error-event"><code>error</code></a> event with the <a href="#dfn-error"><code>error</code></a>
	  attribute returning a <a href="#dfn-NotFoundError"><code>NotFoundError</code></a> <a href="#dfn-domerror"><code>DOMError</code></a>.</p>
    <div class="example"><div class="exampleHeader">Example</div>
    <p>In the examples below, metadata from a file object is displayed meaningfully, and a file object is created with a name and a last modified date.</p>
    <div class="block"><div class="blockTitleDiv"><span class="blockTitle">ECMAScript</span></div><div class="blockContent"><pre class="code"><code class="es-code">
var file = document.getElementById("filePicker").files[0];
var date = new Date(file.lastModified);
println("You selected the file " + file.name + " which was modified on " + date.toDateString() + " .");

...

// Generate a file with a specific last modified date

var d = new Date(2013, 12, 5, 16, 23, 45, 600);
var generatedFile = new File(["Rough Draft ...."], "Draft1.txt", {type: "text/plain"; lastModified: d})

...

</code></pre></div></div>
	  </div>
<div id="filelist-section" class="section">
        <h2>7. The FileList Interface</h2>
<div class="note"><p>The <code>FileList</code> interface should be considered "at risk" since the general trend on the Web Platform is to replace such interfaces with the <code>Array</code> platform object in ECMAScript [<a href="#ECMA-262">ECMA-262</a>]. In particular, this means syntax of the sort <code>filelist.item(0)</code> is at risk; most other programmatic use of <code>FileList</code> is unlikely to be affected by the eventual migration to an <code>Array</code> type. </p></div>
       
       <p>
          This interface is a list of <a href="#dfn-file"><code>File</code></a> objects.
       </p>
    <div class="block"><div class="blockTitleDiv"><span class="blockTitle">IDL</span></div><div class="blockContent"><pre class="code"><code class="idl-code">
    [Exposed=Window,Worker] interface <dfn id="dfn-filelist">FileList</dfn> {
      getter <a href="#dfn-file" class="dfnref">File</a>? <a href="#dfn-item" class="dfnref">item</a>(unsigned long <a href="#dfn-index" class="dfnref">index</a>);
      readonly attribute unsigned long <a href="#dfn-length" class="dfnref">length</a>;
    };
    </code></pre></div></div>
    <div class="example"><div class="exampleHeader">Example</div>
    <p>
      Sample usage typically involves DOM access to the <code>&lt;input type="file"&gt;</code> element within a form, and then accessing selected files.  
    </p>
    <div class="block"><div class="blockTitleDiv"><span class="blockTitle">ECMAScript</span></div><div class="blockContent"><pre class="code"><code class="es-code">
    <span class="comment">// uploadData is a form element</span>
    <span class="comment">// fileChooser is input element of type 'file'</span>
    var file = document.forms['uploadData']['fileChooser'].files[0];
    
    <span class="comment">// alternative syntax can be</span>
    <span class="comment">// var file = document.forms['uploadData']['fileChooser'].files.item(0);</span>
    
    if(file)
    {
      <span class="comment">// Perform file ops</span>
    }  
    </code></pre></div></div>
    </div>
    <div class="section" id="attributes-filelist">
    <h3>7.1. Attributes</h3>
    <dl>
      <dt id="dfn-length"><code>length</code></dt><dd><p>must return the number of files in the <a href="#dfn-filelist"><code>FileList</code></a> object.  If there are no files, this attribute must return 0.</p></dd>
    </dl>
    </div>
    <div class="section" id="filelist-methods-params">
    <h3>7.2. Methods and Parameters</h3>
    <dl>
      <dt id="dfn-item"><code>item(index)</code></dt><dd><p>must return the <em>indexth</em> <a href="#dfn-file"><code>File</code></a> object in
      the <a href="#dfn-filelist"><code>FileList</code></a>.  If there is no <em>indexth</em> <a href="#dfn-file"><code>File</code></a> object in the
      <a href="#dfn-filelist"><code>FileList</code></a>, then this method must return <code>null</code>.</p>
      <p><dfn id="dfn-index" title="index"><code>index</code></dfn> must be treated by user agents as value for the position of a <a href="#dfn-file"><code>File</code></a>
      object in the <a href="#dfn-filelist"><code>FileList</code></a>, with 0 representing the first file.  <strong>Supported property indices</strong> [<a href="#WebIDL">WebIDL</a>] are the numbers in the range zero to one less than the number of <a href="#dfn-file"><code>File</code></a> objects represented by the <code>FileList</code> object.  
If there are no such <a href="#dfn-file"><code>File</code></a> objects, then there are no supported property indices [<a href="#WebIDL">WebIDL</a>]. 
</p>
      </dd>
    
    </dl>
    </div>
    <div class="note"><div class="noteHeader">Note</div>
    The <code>HTMLInputElement</code> interface [<a href="#HTML">HTML</a>] has a readonly attribute of type <code>FileList</code>, which is what is
    being accessed in the above example.  Other interfaces with a readonly attribute of type <code>FileList</code> include the <code>DataTransfer</code>
    interface [<a href="#HTML">HTML</a>].
    </div>
    </div>
  
  </div>  
	<div id="reading-data-section" class="section">
	  <h2>8. Reading Data</h2>
    <div id="readOperationSection" class="section">
      <h3>8.1 The Read Operation</h3>
	  
    <p>The algorithm below defines a <a href="#readOperation">read operation</a>, which takes a <a href="#dfn-Blob"><code>Blob</code></a> and a <a href="#synchronousFlag">synchronous flag</a> as input, and reads <a href="#byte">byte</a>s into a byte stream which is returned as the <var>result</var> of the <a href="#readOperation">read operation</a>, or else fails along with a <a href="#failureReason">failure reason</a>. Methods in this specification invoke the <a href="#readOperation">read operation</a> with the <a href="#synchronousFlag">synchronous flag</a> either set or unset.</p>
    <p>The <dfn id="synchronousFlag">synchronous flag</dfn> determines if a read operation is synchronous or asynchronous, and is <em>unset</em> by default. Methods may set it. If it is set, the <a href="#readOperation">read operation</a> takes place synchronously. Otherwise, it takes place asynchronously.  </p>
    <p>To perform a <dfn id="readOperation">read operation</dfn> on a <a href="#dfn-Blob"><code>Blob</code></a> and the <a href="#synchronousFlag">synchronous flag</a>, run the following steps:</p>
    <ol>

      <li><p>Let <var>s</var> be a a new <a href="#dfn-body">body</a>, <var>b</var> be the <a href="#dfn-Blob"><code>Blob</code></a> to be read from, and <var>bytes</var> initially set to an empty byte sequence. Set the <var>length</var> on <var>s</var> to the <a href="#dfn-size"><code>size</code></a> of <var>b</var>. While there are still bytes to be read in <var>b</var> perform the following substeps:</p>

      <div class="note"><div class="noteHeader">Note</div><p>The algorithm assumes that invoking methods have checked for <a href="#readabilityState">readability state</a>. A <a href="#dfn-Blob"><code>Blob</code></a> in the <a href="#dfn-closedState"><code>CLOSED</code></a> state must not have a <a href="#readOperation">read operation</a> called on it.</p></div>
      <ol>
       
        <li><p>If the <a href="#synchronousFlag">synchronous flag</a> is set, follow the steps below: </p>
          <ol><li><p>Let <var>bytes</var> be the byte sequence that results from reading a <a href="#chunk">chunk</a> from <var>b</var>. If <a href="#file-error-read">an error occurs</a> reading a <a href="#chunk">chunk</a> from <var>b</var>, return <var>s</var> with the error flag set, along with a <a href="#failureReason">failure reason</a>, and <a href="#terminate-an-algorithm">terminate this algorithm</a>. </p>
          <div class="note"><div class="noteHeader">Note</div>
         <p>Along with returning failure, the synchronous part of this algorithm must return the <a href="#failureReason">failure reason</a> that occurred for <a href="#throw-an-exception">throwing an exception</a> by synchronous methods that invoke this algorithm with the <a href="#synchronousFlag">synchronous flag</a> set. </p>
        </div>
        </li>
        <li><p>If there are no errors, push <var>bytes</var> to <var>s</var>, and increment <var>s</var>'s <var>transmitted</var> [<a href="#Fetch">Fetch</a>] by the number of bytes in <var>bytes</var>. Reset <var>bytes</var> to the empty byte sequence and continue reading <a href="#chunk">chunk</a>s as above.</p></li>
        <li><p>When all the bytes of <var>b</var> have been read into <var>s</var>, return <var>s</var> and <a href="#terminate-an-algorithm">terminate this algorithm</a>.</p></li>
      </ol>

      </li>
      <li><p>Otherwise, the <a href="#synchronousFlag">synchronous flag</a> is unset. Return <var>s</var> and process the rest of this algorithm asynchronously.</p></li>
      <li><p>Let <var>bytes</var> be the byte sequence that results from reading a <a href="#chunk">chunk</a> from <var>b</var>. If <a href="#file-error-read">an error occurs</a> reading a <a href="#chunk">chunk</a> from <var>b</var>, set the error flag on <var>s</var>, and <a href="#terminate-an-algorithm">terminate this algorithm</a> with a <a href="#failureReason">failure reason</a>.</p>
          <div class="note"><div class="noteHeader">Note</div>
         <p>The asynchronous part of this algorithm must signal the <a href="#failureReason">failure reason</a> that occurred for asynchronous error reporting by methods expecting <var>s</var> and which invoke this algorithm with the <a href="#synchronousFlag">synchronous flag</a> unset. </p>
        </div></li>
      <li><p>If no <a href="#file-error-read">error</a> occurs, push <var>bytes</var> to <var>s</var>, and increment <var>s</var>'s <var>transmitted</var> [<a href="#Fetch">Fetch</a>] by the number of bytes in <var>bytes</var>. Reset <var>bytes</var> to the empty byte sequence and continue reading <a href="#chunk">chunk</a>s as above. </p></li>
      
    </ol>

    <p>To perform an <dfn id="task-read-operation">annotated task read operation</dfn> on a <a href="#dfn-Blob">Blob</a> <var>b</var>, perform the steps below:</p>
    <ol>
    <li><p>Perform a <a href="#readOperation">read operation</a> on <var>b</var> with the <a href="#synchronousFlag">synchronous flag</a> unset, along with the additional steps below.</p></li>
    <li><p>If the <a href="#readOperation">read operation</a> terminates with a <a href="#failureReason">failure reason</a>, <a href="#queue-a-task">queue a task</a> to <dfn id="process-read-error">process read error</dfn> with the <a href="#failureReason">failure reason</a> and terminate this algorithm.</p></li>
    <li><p>When the first <a href="#chunk">chunk</a> is being pushed to the <a href="#dfn-body">body</a> <var>s</var> during the <a href="#readOperation">read operation</a>, <a href="#queue-a-task">queue a task</a> to <dfn id="process-read">process read</dfn>.</p></li> 
    <li><p>Once the <a href="#dfn-body">body</a> <var>s</var> from the <a href="#readOperation">read operation</a> has at least one <a href="#chunk">chunk</a> read into it, or there are no <a href="#chunk">chunk</a>s left to read from <var>b</var>, <a href="#queue-a-task">queue a task</a> to <dfn id="process-read-data">process read data</dfn>. Keep <a href="#queue-a-task">queuing tasks</a> to <a href="#process-read-data">process read data</a> for every <a href="#chunk">chunk</a> read or every 50ms, whichever is <em>least frequent</em>.</p></li> 
    <li><p>When all of the <a href="#chunk">chunk</a>s from <var>b</var> are read into the <a href="#dfn-body">body</a> <var>s</var> from the <a href="#readOperation">read operation</a>, <a href="#queue-a-task">queue a task</a> to <dfn id="process-read-EOF">process read EOF</dfn>.</p></li>
    </ol>
   </li>
  </ol>
  <p>Use the <a href="#fileReadingTaskSource">file reading task source</a> for all these tasks.</p>
 </div>

 <div id="blobreader-task-source" class="section">
  <h3>8.2. The File Reading Task Source</h3>
 <p>This specification defines a new generic <a href="#task-source">task source</a> called the <dfn id="fileReadingTaskSource">file reading task source</dfn>, which is used for all <a href="#queue-a-task">tasks that are queued</a> in this specification to read byte sequences associated with <a href="#dfn-Blob"><code>Blob</code></a> and <a href="#dfn-file"><code>File</code></a> objects.  It is to be used for features that trigger in response to asynchronously reading binary data.</p>  
 </div>
<div id="APIASynch" class="section">
  <h3>8.3 The FileReader API</h3>
	  <div class="block"><div class="blockTitleDiv"><span class="blockTitle">IDL</span></div><div class="blockContent"><pre class="code"><code class="idl-code">

	[Constructor, Exposed=Window,Worker]
	interface <dfn id="dfn-filereader">FileReader</dfn>: EventTarget {

	  <span class="comment">// async read methods</span>
	  void <a href="#dfn-readAsArrayBuffer" class="dfnref">readAsArrayBuffer</a>(<a href="#dfn-Blob" class="dfnref">Blob</a> <a href="#dfn-fileBlob" class="dfnref">blob</a>);
	  void <a href="#dfn-readAsText" class="dfnref">readAsText</a>(<a href="#dfn-Blob" class="dfnref">Blob</a> <a href="#dfn-fileBlob" class="dfnref">blob</a>, optional DOMString <a href="#dfn-label" class="dfnref">label</a>);
	  void <a href="#dfn-readAsDataURL" class="dfnref">readAsDataURL</a>(<a href="#dfn-Blob" class="dfnref">Blob</a> <a href="#dfn-fileBlob" class="dfnref">blob</a>);

	  void <a href="#dfn-abort" class="dfnref">abort</a>();

	  <span class="comment">// states</span>
	  const unsigned short <a href="#dfn-empty" class="dfnref">EMPTY</a> = 0;
	  const unsigned short <a href="#dfn-loading" class="dfnref">LOADING</a> = 1;
	  const unsigned short <a href="#dfn-done" class="dfnref">DONE</a> = 2;


	  readonly attribute unsigned short <a class="dfnref" href="#dfn-readyState">readyState</a>;

	  <span class="comment">// File or Blob data</span>
	  readonly attribute (DOMString or ArrayBuffer)? <a href="#dfn-result" class="dfnref">result</a>;

	  readonly attribute <a href="#dfn-domerror" class="dfnref">DOMError</a>? <a href="#dfn-error" class="dfnref">error</a>;

	  <span class="comment">// event handler attributes</span>
	  attribute <a href="http://www.w3.org/html/wg/drafts/html/master/webappapis.html#eventhandler">EventHandler</a> <a href="#dfn-onloadstart" class="dfnref">onloadstart</a>;
	  attribute <a href="http://www.w3.org/html/wg/drafts/html/master/webappapis.html#eventhandler">EventHandler</a> <a href="#dfn-onprogress" class="dfnref">onprogress</a>;
	  attribute <a href="http://www.w3.org/html/wg/drafts/html/master/webappapis.html#eventhandler">EventHandler</a> <a class="dfnref" href="#dfn-onload">onload</a>;
	  attribute <a href="http://www.w3.org/html/wg/drafts/html/master/webappapis.html#eventhandler">EventHandler</a> <a class="dfnref" href="#dfn-onabort">onabort</a>;
	  attribute <a href="http://www.w3.org/html/wg/drafts/html/master/webappapis.html#eventhandler">EventHandler</a> <a class="dfnref" href="#dfn-onerror">onerror</a>;
	  attribute <a href="http://www.w3.org/html/wg/drafts/html/master/webappapis.html#eventhandler">EventHandler</a> <a class="dfnref" href="#dfn-onloadend">onloadend</a>;

	};
	  </code></pre></div></div>
	
	<div id="filereaderConstrctr" class="section">
	<h4>8.3.1. Constructors</h4>
	<p>When the <code>FileReader()</code> constructor is invoked, the user agent must return a new <a href="#dfn-filereader"><code>FileReader</code></a> object. </p>
	<p>In environments where the global object is represented by a <code>Window</code> or a <code>WorkerGlobalScope</code> object, the <code>FileReader</code> constructor
	must be available.</p>
	</div>
	<div id="event-handler-attributes-section" class="section">
	<h4>8.3.2. Event Handler Attributes</h4>
	<p>
	The following are the <a href="#event-handler-attributes">event
	   handler attributes</a> (and their corresponding <a href="#event-handler-event-type" title="event handler event type">event
	   handler event types</a>) that user agents must support on
	   <code><a href="#dfn-filereader">FileReader</a></code> as
	   DOM attributes:  
	</p>
	<table>

	   <thead>
	    <tr>
	     <th><a href="#event-handler-attributes" title="event handler        attributes">event handler attribute</a>

	     </th><th><a href="#event-handler-event-type">event handler event type</a>

	   </th></tr></thead><tbody>
	    <tr>

	     <td><dfn id="dfn-onloadstart"><code>onloadstart</code></dfn>

	     </td><td><code><a href="#dfn-loadstart-event">loadstart</a></code>

	    </td></tr><tr>
	     <td><dfn id="dfn-onprogress"><code>onprogress</code></dfn>

	     </td><td><code><a href="#dfn-progress-event">progress</a></code>

	    </td></tr><tr>
	     <td><dfn id="dfn-onabort"><code>onabort</code></dfn>

	     </td><td><code title="abort-event"><a href="#dfn-abort-event">abort</a></code>

	    </td></tr><tr>
	     <td><dfn id="dfn-onerror"><code>onerror</code></dfn>

	     </td><td><code><a href="#dfn-error-event">error</a></code>

	    </td></tr><tr>
	     <td><dfn id="dfn-onload"><code>onload</code></dfn>

	     </td><td><code><a href="#dfn-load-event">load</a></code>

	    </td></tr><tr>
	     <td><dfn id="dfn-onloadend"><code>onloadend</code></dfn>

	     </td><td><code><a href="#dfn-loadend-event">loadend</a></code>
	  </td></tr></tbody></table>


	</div>
	<div id="blobreader-state" class="section">
	<h4>8.3.3. FileReader States</h4>
	<p>The <a href="#dfn-filereader" class="dfnref"><code>FileReader</code></a> object can be in one of 3 states.  The
	<dfn id="dfn-readyState"><code>readyState</code></dfn> attribute, on getting,
	must return the current state, which must be one of the following values:</p>
	<dl>
	 <dt><dfn id="dfn-empty"><code>EMPTY</code> (numeric value 0)</dfn></dt>
	 <dd><p>The <code>FileReader</code> object has been constructed, and there are no pending reads.  None of the <a href="#read-methods">read methods</a> have been called.  This is the
	 default state of a newly minted <code>FileReader</code> object, until one of the <a href="#read-methods">read methods</a> have been called on it.</p></dd>
	 <dt><dfn id="dfn-loading"><code>LOADING</code> (numeric value 1)</dfn></dt>
	 <dd><p>A <a href="#dfn-file"><code>File</code></a> or <a href="#dfn-Blob"><code>Blob</code></a> is being read.  One of the <a href="#read-methods">read methods</a> is being processed,
	 and no error has occurred during the read.</p></dd>
	 <dt><dfn id="dfn-done"><code>DONE</code> (numeric value 2)</dfn></dt>
	 <dd><p>The entire <a href="#dfn-file"><code>File</code></a> or <a href="#dfn-Blob"><code>Blob</code></a> has been read into memory,
	 OR a <a href="#file-error-read">file error occurred during read</a>, OR the read was
	 aborted using <a href="#dfn-abort"><code>abort()</code></a>.
	 The <a href="#dfn-filereader" class="dfnref"><code>FileReader</code></a>
	is no longer reading a <a href="#dfn-file"><code>File</code></a> or <a href="#dfn-Blob"><code>Blob</code></a>.  If <code>readyState</code> is set to <code>DONE</code> it means
	at least one of the <a href="#read-methods">read methods</a> have been called on this <code>FileReader</code>.</p></dd>
	</dl>
	</div>
	<div id="reading-a-file" class="section">
	<h4>8.3.4. Reading a File or Blob</h4>
	<div class="section" id="MultipleReads">
	<h4>Multiple Reads</h4>
	<p>
	 The <a href="#dfn-filereader" class="dfnref"><code>FileReader</code></a> interface makes available three asynchronous <dfn id="read-methods">read methods</dfn> - <a href="#dfn-readAsArrayBuffer"><code>readAsArrayBuffer</code></a>, <a href="#dfn-readAsText" class="dfnref"><code>readAsText</code></a>, and <a href="#dfn-readAsDataURL" class="dfnref"><code>readAsDataURL</code></a>, which <em>read files into memory</em>.  If multiple concurrent read methods are called on the same <a href="#dfn-filereader" class="dfnref"><code>FileReader</code></a> object, user agents must throw an <code>InvalidStateError</code> [<a href="#DOM4">DOM4</a>] on any of the read methods that occur when <a href="#dfn-readyState"><code>readyState</code></a> = <a href="#dfn-loading"><code>LOADING</code></a>.
	</p>
	</div>
	<div id="filedata-attr" class="section">
	<h5>8.3.4.1. The <code>result</code> attribute</h5>
	<p>On getting, the <dfn id="dfn-result"><code>result</code></dfn> attribute returns a <a href="#dfn-Blob"><code>Blob</code></a>'s data as a <code>DOMString</code>, or as
	an <code>ArrayBuffer</code> [<a href="#TypedArrays">TypedArrays</a>], or <code>null</code>, depending on the <a href="#read-methods" class="#dfnref">read method</a>
	that has been called on the <a href="#dfn-filereader" class="dfnref"><code>FileReader</code></a>, and any errors that may have occurred.
	
	The list below is normative for the <code>result</code> attribute and is the conformance criteria for this attribute:
	</p>
	<ul>
	  <li><p>On getting, if the <a href="#dfn-readyState" class="dfnref"><code>readyState</code></a> is <code>EMPTY</code> (no read method has been called)
	  then the <code>result</code> attribute must return <code>null</code>.</p></li>
	  <li><p>On getting, if an error in reading the <a href="#dfn-file"><code>File</code></a> or <a href="#dfn-Blob"><code>Blob</code></a> has
	  occurred (using <em>any</em> <a href="#read-methods"> read method</a>),
	  then the <code>result</code> attribute must return <code>null</code>.</p></li>
	  <li><p>On getting, if the <a href="#dfn-readAsDataURL" class="#dfnref"><code>readAsDataURL</code></a> <a href="#read-methods">read method</a> is
	  used, the <code>result</code> attribute must return a <code>DOMString</code> that is a Data URL [<a href="#DataURL">DataURL</a>] encoding of the
	  <a href="#dfn-file"><code>File</code></a> or <a href="#dfn-Blob"><code>Blob</code></a>'s data.</p></li>
	  <li><p>On getting, if the <a href="#dfn-readAsText" class="dfnref"><code>readAsText</code></a> <a href="#read-methods">read method</a> is called
	  and no error in reading the <a href="#dfn-file"><code>File</code></a> or <a href="#dfn-Blob"><code>Blob</code></a> has occurred,
	  then the <code>result</code> attribute must return a string representing the <a href="#dfn-file"><code>File</code></a> or <a href="#dfn-Blob"><code>Blob</code></a>'s
	  data as a text string, and should decode the string into memory in the format specified
	  by the <a href="#encoding-determination">encoding determination</a> as a <code>DOMString</code>.
	  </p></li>
	  <li><p>On getting, if the <a href="#dfn-readAsArrayBuffer"><code>readAsArrayBuffer</code></a> <a href="#read-methods">read method</a> is called
	  and no error in reading the <a href="#dfn-file"><code>File</code></a> or <a href="#dfn-Blob"><code>Blob</code></a> has occurred,
	  then the <code>result</code> attribute must return an <code>ArrayBuffer</code> [<a href="#TypedArrays">TypedArrays</a>] object. </p></li>
	</ul>
	 
	</div>
	<div id="readAsDataURL" class="section">
	<h5>8.3.4.2. The <code>readAsDataURL(blob)</code> method</h5>
	<p>When the <dfn id="dfn-readAsDataURL"><code>readAsDataURL(blob)</code></dfn> method is called, the user agent must run the steps below.</p>
	<ol>
	<li><p>If <a href="#dfn-readyState"><code>readyState</code></a> = <a href="#dfn-loading"><code>LOADING</code></a> throw an <code>InvalidStateError</code> exception [<a href="#DOM4">DOM4</a>] and <a href="#terminate-an-algorithm">terminate this algorithm</a>.
	  </p>
	<p><strong>Note:</strong> The <a href="#dfn-readAsDataURL"><code>readAsDataURL()</code></a> method returns due to the algorithm being <a href="#terminate-an-algorithm">terminated</a>.</p>
	</li> 
  <li><p>If the <a href="#dfn-fileBlob"><code>blob</code></a> is in the <a href="#dfn-closedState">CLOSED</a> <a href="#readabilityState">readability state</a>, set the <a href="#dfn-error"><code>error</code></a> attribute of the <a href="#contextObject">context object</a> to return an <code>InvalidStateError</code> <a href="#dfn-domerror">DOMError</a> and <a href="#fire-a-progress-event">fire a progress event</a> called <a href="#dfn-error-event"><code>error</code></a> at the <a href="#contextObject">context object</a>. <a href="#terminate-an-algorithm">Terminate this algorithm</a>.</p>
  </li>
    <li><p>Otherwise set <a href="#dfn-readyState" class="dfnref"><code>readyState</code></a> to <a href="#dfn-loading"><code>LOADING</code></a>. </p></li> 
	  <li><p>Initiate an <a href="#task-read-operation">annotated task read operation</a> using the <a href="#dfn-fileBlob"><code>blob</code></a> argument as <var>input</var> and handle <a href="#queue-a-task">tasks queued</a> on the <a href="#fileReadingTaskSource">file reading task source</a> per below.  
    </p>
	  </li>
	
    <li><p>To <a href="#process-read-error">process read error</a> with a <a href="#failureReason">failure reason</a>, proceed to the <a href="#dfn-error-steps">error steps</a>.</p></li>
	  <li><p>To <a href="#process-read">process read</a> <a href="#fire-a-progress-event">fire a progress event</a> called <a href="#dfn-loadstart-event"><code>loadstart</code></a> at the <a href="#contextObject">context object</a>.</p></li>
	<li><p>To <a href="#process-read-data">process read data</a> <a href="#fire-a-progress-event">fire a progress event</a> called <a href="#dfn-progress-event"><code>progress</code></a> at the <a href="#contextObject">context object</a>. </p></li>
	  <li><p>To <a href="#process-read-EOF">process read EOF</a> run these substeps:</p> 

      <ol><li><p>Set <a href="#dfn-readyState"><code>readyState</code></a> to <a href="#dfn-done"><code>DONE</code>.</a></p></li>
      <li><p>Set the <a href="#dfn-result"><code>result</code></a> attribute to the <a href="#dfn-body">body</a> returned by the <a href="#readOperation">read operation</a> as a
	  DataURL [<a href="#DataURL">DataURL</a>]; on getting, the <a href="#dfn-result" class="dfnref"><code>result</code></a> attribute returns the <a href="#dfn-fileBlob"><code>blob</code></a> as a
	  Data URL [<a href="#DataURL">DataURL</a>].</p>
    <ul>
    <li><p>Use the <a href="#dfn-fileBlob"><code>blob</code></a>'s <a href="#dfn-type"><code>type</code></a>
    attribute as part of the Data URL if it is available in keeping with the Data URL specification [<a href="#DataURL">DataURL</a>].</p></li>
    <li><p>If the <a href="#dfn-type"><code>type</code></a> attribute is not available on the <a href="#dfn-fileBlob"><code>blob</code></a> return a Data URL without a media-type.
    [<a href="#DataURL">DataURL</a>].</p>
    <p>Data URLs that do not have media-types [<a href="#RFC2046">RFC2046</a>] must be treated as plain text by conforming user agents. [<a href="#DataURL">DataURL</a>].
  </p>

    </li>
    </ul>
  </li>
    <li><a href="#fire-a-progress-event">Fire a progress event</a> called <a href="#dfn-load-event"><code>load</code></a> at the <a href="#contextObject">context object</a>.</li>
    <li>Unless <a href="#dfn-readyState"><code>readyState</code></a> is <a href="#dfn-loading"><code>LOADING</code></a> <a href="#fire-a-progress-event">fire a progress event</a> called <a href="#dfn-loadend-event"><code>loadend</code></a> at the <a href="#contextObject">context object</a>.  If <a href="#dfn-readyState"><code>readyState</code></a> is <a href="#dfn-loading"><code>LOADING</code></a> do NOT fire <a href="#dfn-loadend-event"><code>loadend</code></a> at the <a href="#contextObject">context object</a>. </li>
  </ol>
</li>
	  <li><p><a href="#terminate-an-algorithm">Terminate this algorithm</a>.</p></li>
	</ol>
	</div>
	<div id="readAsDataText" class="section">
	<h5>8.3.4.3. The <code>readAsText(blob, label)</code> method</h5>
	<p>The <code>readAsText()</code> method can be called with an optional parameter, <dfn id="dfn-label"><code>label</code></dfn>, which is a <code>DOMString</code> argument that represents the label of an encoding [<a href="#encodingSpecification">Encoding Specification</a>]; if provided, it must be used as part of the <a href="#encoding-determination">encoding determination</a> used when processing this method call. </p>
  <p>
	When the <dfn id="dfn-readAsText"><code>readAsText(blob, label)</code></dfn> method is called (the <a href="#dfn-label"><code>label</code></a> argument is optional),
	the user agent must run the steps below.
	</p>
	<ol>
	<li><p>If <a href="#dfn-readyState"><code>readyState</code></a> = <a href="#dfn-loading"><code>LOADING</code></a> throw an <code>InvalidStateError</code> [<a href="#DOM4">DOM4</a>] and terminate these steps.
	  </p>

	<p><strong>Note:</strong> The <a href="#dfn-readAsText"><code>readAsText()</code></a> method returns due to the algorithm being <a href="#terminate-an-algorithm">terminated</a>.</p>
	</li>
  <li><p>If the <a href="#dfn-fileBlob"><code>blob</code></a> is in the <a href="#dfn-closedState">CLOSED</a> <a href="#readabilityState">readability state</a>, set the <a href="#dfn-error"><code>error</code></a> attribute of the <a href="#contextObject">context object</a> to return an <code>InvalidStateError</code> <a href="#dfn-domerror">DOMError</a> and <a href="#fire-a-progress-event">fire a progress event</a> called <a href="#dfn-error-event"><code>error</code></a> at the <a href="#contextObject">context object</a>. <a href="#terminate-an-algorithm">Terminate this algorithm</a>.</p>
  </li> 
	  <li><p>Otherwise set <a href="#dfn-readyState" class="dfnref"><code>readyState</code></a> to <a href="#dfn-loading"><code>LOADING</code></a>. </p></li> 
    <li><p>Initiate an <a href="#task-read-operation">annotated task read operation</a> using the <a href="#dfn-fileBlob"><code>blob</code></a> argument as <var>input</var> and handle <a href="#queue-a-task">tasks queued</a> on the <a href="#fileReadingTaskSource">file reading task source</a> per below.   
    </p>
    </li>
     <li><p>To <a href="#process-read-error">process read error</a> with a <a href="#failureReason">failure reason</a>, proceed to the <a href="#dfn-error-steps">error steps</a>.</p></li>
    <li><p>To <a href="#process-read">process read</a> <a href="#fire-a-progress-event">fire a progress event</a> called <a href="#dfn-loadstart-event"><code>loadstart</code></a> at the <a href="#contextObject">context object</a>.</p></li>
  <li><p>To <a href="#process-read-data">process read data</a> <a href="#fire-a-progress-event">fire a progress event</a> called <a href="#dfn-progress-event"><code>progress</code></a> at the <a href="#contextObject">context object</a>. </p></li>
	
	  <li><p>To <a href="#process-read-EOF">process read EOF</a> run these substeps:</p> 

      <ol><li><p>Set <a href="#dfn-readyState"><code>readyState</code></a> to <a href="#dfn-done"><code>DONE</code></a></p></li>
          <li><p>Set the <a href="#dfn-result"><code>result</code></a> attribute to the <a href="#dfn-body">body</a> returned by the <a href="#readOperation">read operation</a>, represented as a string in a format determined by the <a href="#encoding-determination">encoding determination</a>.  </p></li>
         <li><a href="#fire-a-progress-event">Fire a progress event</a> called <a href="#dfn-load-event"><code>load</code></a> at the <a href="#contextObject">context object</a>.</li>
    <li>Unless <a href="#dfn-readyState"><code>readyState</code></a> is <a href="#dfn-loading"><code>LOADING</code></a> <a href="#fire-a-progress-event">fire a progress event</a> called <a href="#dfn-loadend-event"><code>loadend</code></a> at the <a href="#contextObject">context object</a>.  If <a href="#dfn-readyState"><code>readyState</code></a> is <a href="#dfn-loading"><code>LOADING</code></a> do NOT fire <a href="#dfn-loadend-event"><code>loadend</code></a> at the <a href="#contextObject">context object</a>. </li>
        </ol>
      </li>
	  <li><p><a href="#terminate-an-algorithm">Terminate this algorithm</a>.
	  </p></li>
	</ol>
	</div>
	  <div id="readAsArrayBuffer" class="section">
	<h5>8.3.4.4. The <code>readAsArrayBuffer(blob)</code> method</h5>
	<p>
	When the <dfn id="dfn-readAsArrayBuffer"><code>readAsArrayBuffer(blob)</code></dfn> method is called, the user agent must run the steps below.
	</p>
	<ol>
	 <li><p>If <a href="#dfn-readyState"><code>readyState</code></a> = <a href="#dfn-loading"><code>LOADING</code></a> throw an <code>InvalidStateError</code> exception [<a href="#DOM4">DOM4</a>] and terminate these steps.
	  </p>

	<p><strong>Note:</strong> The <a href="#dfn-readAsArrayBuffer"><code>readAsArrayBuffer()</code></a> method returns due to the algorithm being <a href="#terminate-an-algorithm">terminated</a>.</p>
	</li>
  <li><p>If the <a href="#dfn-fileBlob"><code>blob</code></a> is in the <a href="#dfn-closedState">CLOSED</a> <a href="#readabilityState">readability state</a>, set the <a href="#dfn-error"><code>error</code></a> attribute of the <a href="#contextObject">context object</a> to return an <code>InvalidStateError</code> <a href="#dfn-domerror">DOMError</a> and <a href="#fire-a-progress-event">fire a progress event</a> called <a href="#dfn-error-event"><code>error</code></a> at the <a href="#contextObject">context object</a>. <a href="#terminate-an-algorithm">Terminate this algorithm</a>.</p>
  <p><strong>Note:</strong> The <a href="#dfn-readAsArrayBuffer"><code>readAsArrayBuffer()</code></a> method returns due to the algorithm being <a href="#terminate-an-algorithm">terminated</a>.</p>
  </li> 
	<li><p>Otherwise set <a href="#dfn-readyState" class="dfnref"><code>readyState</code></a> to <a href="#dfn-loading"><code>LOADING</code></a>. </p></li> 
    <li><p>Initiate an <a href="#task-read-operation">annotated task read operation</a> using the <a href="#dfn-fileBlob"><code>blob</code></a> argument as <var>input</var> and handle <a href="#queue-a-task">tasks queued</a> on the <a href="#fileReadingTaskSource">file reading task source</a> per below.   
    </p>
    </li>
     <li><p>To <a href="#process-read-error">process read error</a> with a <a href="#failureReason">failure reason</a>, proceed to the <a href="#dfn-error-steps">error steps</a>.</p></li>
    <li><p>To <a href="#process-read">process read</a> <a href="#fire-a-progress-event">fire a progress event</a> called <a href="#dfn-loadstart-event"><code>loadstart</code></a> at the <a href="#contextObject">context object</a>.</p></li>
  <li><p>To <a href="#process-read-data">process read data</a> <a href="#fire-a-progress-event">fire a progress event</a> called <a href="#dfn-progress-event"><code>progress</code></a> at the <a href="#contextObject">context object</a>. </p></li>
  
	   <li><p>To <a href="#process-read-EOF">process read EOF</a> run these substeps:</p> 
      <ol><li><p>Set <a href="#dfn-readyState"><code>readyState</code></a> to <a href="#dfn-done"><code>DONE</code></a></p></li>
          <li><p>Set the <a href="#dfn-result"><code>result</code></a> attribute to the <a href="#dfn-body">body</a> returned by the <a href="#readOperation">read operation</a> as an <code>ArrayBuffer</code> [<a href="#TypedArrays">TypedArrays</a>] object. </p> </li>
          <li><p><a href="#fire-a-progress-event">Fire a progress event</a> called <a href="#dfn-load-event"><code>load</code></a> at the <a href="#contextObject">context object</a>.</p></li>
          <li><p>Unless <a href="#dfn-readyState"><code>readyState</code></a> is <a href="#dfn-loading"><code>LOADING</code></a> <a href="#fire-a-progress-event">fire a progress event</a> called <a href="#dfn-loadend-event"><code>loadend</code></a> at the <a href="#contextObject">context object</a>.  If <a href="#dfn-readyState"><code>readyState</code></a> is <a href="#dfn-loading"><code>LOADING</code></a> do NOT fire <a href="#dfn-loadend-event"><code>loadend</code></a> at the <a href="#contextObject">context object</a>. </p></li>
        </ol>
      </li>
	  <li><p><a href="#terminate-an-algorithm">Terminate this algorithm</a>.</p></li>
	</ol>
	</div>
  <div id="dfn-error-steps" class="section">
    <h5>8.3.4.5. Error Steps</h5>
    <p>These <em>error steps</em> are to <a href="#process-read-error">process read error</a> with a <a href="#failureReason">failure reason</a>.</p>
        <ol>
        <li>Set the <a href="#contextObject">context object</a>'s <a href="#dfn-readyState"><code>readyState</code></a> to <a href="#dfn-done"><code>DONE</code></a> and <a href="#dfn-result"><code>result</code></a> to null if it is not already set to null. </li>  
      <li><p><em>Set the <a href="#dfn-error"><code>error</code></a> attribute</em> on the <a href="#contextObject">context object</a>; on getting, the
      <a href="#dfn-error"><code>error</code></a> attribute must be a
      a <a href="#dfn-domerror"><code>DOMError</code></a> object that corresponds to the <a href="#failureReason">failure reason</a>.  <a href="#fire-a-progress-event">Fire a progress event</a> called
      <a href="#dfn-error-event"><code>error</code></a> at the <a href="#contextObject">context object</a>.  </p></li>
      <li><p>Unless <a href="#dfn-readyState"><code>readyState</code></a> is <a href="#dfn-loading"><code>LOADING</code></a>, <a href="#fire-a-progress-event">fire a progress event</a> called
      <a href="#dfn-loadend-event" class="dfnref"><code>loadend</code></a> at the <a href="#contextObject">context object</a>.  If <a href="#dfn-readyState"><code>readyState</code></a> is <a href="#dfn-loading"><code>LOADING</code></a> do NOT fire <a href="#dfn-loadend-event" class="dfnref"><code>loadend</code></a> at the <a href="#contextObject">context object</a>.</p></li>
      <li><p><a href="#terminate-an-algorithm">Terminate the algorithm</a> for any <a href="#read-methods">read method</a>.</p>

    <p><strong>Note:</strong> The <a href="#read-methods">read method</a> returns due to the algorithm being terminated.</p> 
  </li>    
    </ol>
  </div>
	<div id="abort" class="section">
	<h5>8.3.4.6. The abort() method</h5>
	<p>
	  When the <dfn id="dfn-abort"><code>abort()</code></dfn> method is called, the user agent must run the steps below:</p>
	  <ol>
	  <li><p>If <a href="#dfn-readyState"><code>readyState</code></a> = <a href="#dfn-empty"><code>EMPTY</code></a> or if <a href="#dfn-readyState"><code>readyState</code></a> = <a href="#dfn-done"><code>DONE</code></a> set <a href="#dfn-result"><code>result</code></a> to <code>null</code>
	  and <a href="#terminate-an-algorithm">terminate this algorithm</a>.</p></li>
	  <li><p>If <a href="#dfn-readyState"><code>readyState</code></a> = <a href="#dfn-loading"><code>LOADING</code></a> set <a href="#dfn-readyState"><code>readyState</code></a> to
	  <a href="#dfn-done"><code>DONE</code></a> and <a href="#dfn-result"><code>result</code></a> to <code>null</code>.</p></li>
	  <li><p>If there are any <a href="#dfn-task">tasks</a> from the <a href="#contextObject">context object</a> on the <a href="#fileReadingTaskSource">file reading task source</a> in an affiliated 
	  <a href="#queue-a-task">task queue</a>, then remove those <a href="#dfn-task">tasks</a> from that task queue.</p></li>
	  <li><p><a href="#terminate-an-algorithm">Terminate the algorithm</a> for the <a href="#read-methods">read method</a> being processed.   </p></li>
	  <li><p><a href="#fire-a-progress-event">Fire a progress event</a> called <a href="#dfn-abort-event"><code>abort</code></a></p></li>
	  <li><p> <a href="#fire-a-progress-event">Fire a progress event</a> called <a href="#dfn-loadend-event"><code>loadend</code>.</a> </p></li>
	  </ol>
	</div>
 
	<div id="blobAndFileParams" class="section">
	<h4>8.3.4.7. Blob Parameters</h4>
	<p>The three <a href="#read-methods">asynchronous read methods</a>, the three <a href="#read-method-sync">synchronous read methods</a>, <a href="#dfn-createObjectURL"><code>URL.createObjectURL</code></a> and <a href="#dfn-createFor"><code>URL.createFor</code></a> take a
	<a href="#dfn-Blob" class="dfnref"><code>Blob</code></a> parameter.  This section defines this parameter.
	</p>
	<dl>
	<dt><dfn id="dfn-fileBlob"><code>blob</code></dfn></dt>
	<dd><p>This is a <a href="#dfn-Blob"><code>Blob</code></a> argument and must be a reference to a single <a href="#dfn-file"><code>File</code></a> in a
	<a href="#dfn-filelist"><code>FileList</code></a> or a <a href="#dfn-Blob"><code>Blob</code></a> argument not obtained from the underlying OS file system.</p></dd>
	</dl>
	</div>
</div>
	  
    <div id="enctype" class="section">
  <h4>8.4. Determining Encoding</h4>
  <p>When reading <a href="#dfn-fileBlob"><code>blob</code></a> objects using the <a href="#dfn-readAsText"><code>readAsText()</code></a> <a href="#read-methods">read method</a>, the following <dfn id="encoding-determination">encoding determination</dfn> steps must be followed:</p>
  <ol>
  <li><p>Let <var>encoding</var> be null</p></li>
  <li><p>If the <a href="#dfn-label"><code>label</code></a> argument is present when calling the method, set <var>encoding</var> to the result of "getting an encoding" using the Encoding Specification [<a href="#encodingSpecification">Encoding Specification</a>] for <a href="#dfn-label"><code>label</code></a>. </p></li>
  <li><p>If the "getting an encoding" steps above return failure, then set <var>encoding</var> to null.</p>
     </li>
  <li><p>If <var>encoding</var> is null, and the <a href="#dfn-fileBlob"><code>blob</code></a> argument's <a href="#dfn-type"><code>type</code></a> attribute is present, and it uses a Charset Parameter [<a href="#RFC2046">RFC2046</a>], set <var>encoding</var> to the result of "getting an encoding" using the Encoding Specification 
  [<a href="#encodingSpecification">Encoding Specification</a>] for the portion of the Charset Parameter that is a <em>label</em> of an encoding.</p>
  <div class="example"><div class="exampleHeader">Example</div>
  <p>If <a href="#dfn-fileBlob"><code>blob</code></a> has a <a href="#dfn-type"><code>type</code></a> attribute of <code>text/plain;charset=UTF-8</code> then 
  "getting an encoding" is run using <a href="#dfn-UTF-8" class="dfnrefs">UTF-8</a> as the label.  Note that user agents must parse and extract the portion of the Charset Parameter that constitutes a <em>label</em> of an encoding.</p>
  </div>
  </li>
  <li><p>If the "getting an encoding" steps above return failure, then set <var>encoding</var> to null.</p></li>
  <li><p>If <var>encoding</var> is null, then set encoding to utf-8.</p></li>
  <li><p>"Decode" [<a href="#encodingSpecification">Encoding Specification</a>] this <a href="#dfn-fileBlob"><code>blob</code></a> using fallback encoding <var>encoding</var>, and return the result.  On getting, the <a href="#dfn-result"><code>result</code></a> attribute of the <a href="#dfn-filereader"><code>FileReader</code></a> object returns a string in <var>encoding</var> format.  The synchronous <a href="#dfn-readAsTextSync"><code>readAsText</code></a> method of the <a href="#dfn-FileReaderSync"><code>FileReaderSync</code></a> object returns a string in <var>encoding</var> format. </p></li>  
  </ol>
  </div>
	 <div id="events" class="section">
  <h3>8.5.10. Events</h3>
  <p>The <a href="#dfn-filereader"><code>FileReader</code></a> object must be the event target for all events in this specification.  </p>

  <p>
    When this specification says to <dfn id="fire-a-progress-event">fire a progress event</dfn> <em>called e</em> (for some
    <code>ProgressEvent</code> <code>e</code> at a given <a href="#dfn-filereader"><code>FileReader</code></a> <code>reader</code> as the <a href="#contextObject">context object</a>),
    the following are normative:</p>
    <ul>
    <li><p>The progress event <code>e</code> does not bubble.  <code>e.bubbles</code> must be false [<a href="#DOM4">DOM4</a>]</p></li>
    <li><p>The progress event <code>e</code> is NOT cancelable. <code>e.cancelable</code> must be false [<a href="#DOM4">DOM4</a>]</p></li>
    <li><p>The term <dfn id="fire-an-event">"fire an event"</dfn> is defined in DOM Core [<a href="#DOM4">DOM4</a>].  Progress Events are defined in Progress Events
    [<a href="#ProgressEvents">ProgressEvents</a>].</p></li> 
    </ul>
    <div id="event-summary" class="section">
    <h4>8.5.10.1. Event Summary</h4>
    <p>The following are the events that are fired at <code><a href="#dfn-filereader">FileReader</a></code> objects; <a href="#fire-a-progress-event">firing events</a> is defined in
    DOM Core [<a href="#DOM4">DOM4</a>].</p>
    <table id="event-summary-table">

     <thead>
      <tr>
       <th>Event name

       </th><th>Interface

       </th><th>Fired when…

     </th></tr></thead><tbody>
      <tr>
       <td><dfn id="dfn-loadstart-event"><code>loadstart</code></dfn>

       </td><td><code>ProgressEvent</code>

       </td><td>When the read starts.

      </td></tr><tr>

       <td><dfn id="dfn-progress-event"><code>progress</code></dfn>

       </td><td><code>ProgressEvent</code>

       </td><td>While reading (and decoding) <a href="#dfn-fileBlob"><code>blob</code></a>

      </td></tr><tr>
       <td><dfn id="dfn-abort-event" title="abort-event"><code>abort</code></dfn>

       </td><td><code>ProgressEvent</code>

       </td><td>When the read has been aborted. For instance, by invoking the
        <code><a href="#dfn-abort">abort()</a></code> method.

      </td></tr><tr>
       <td><dfn id="dfn-error-event"><code>error</code></dfn>

       </td><td><code>ProgressEvent</code>

       </td><td>When the read has failed (see <a href="#file-error-read">errors</a>).

      </td></tr><tr>

       <td><dfn id="dfn-load-event"><code>load</code></dfn>

       </td><td><code>ProgressEvent</code>

       </td><td>When the read has successfully completed.

      </td></tr><tr>
       <td><dfn id="dfn-loadend-event"><code>loadend</code></dfn>

       </td><td><code>ProgressEvent</code>

       </td><td>When the request has completed (either in success or failure). 
    </td></tr></tbody></table>

    </div>
  <div id="eventInvariants" class="section">
  <h4>8.5.10.2. Summary of Event Invariants</h4>
  <p>
  This section is informative.  The following are invariants applicable to <a href="#fire-an-event">event firing</a> for a given asynchronous <a href="#read-methods">read method</a> in this specification:
  </p>
  <ol> 
    <li><p>Once a <a href="#dfn-loadstart-event"><code>loadstart</code></a> has been fired, a corresponding <a href="#dfn-loadend-event"><code>loadend</code></a> fires at completion of the read, EXCEPT if </p><ul><li><p>the <a href="#read-methods">read method</a> has been cancelled using <a href="#dfn-abort"><code>abort()</code></a> and a new <a href="#read-methods">read method</a> has been invoked;</p></li><li><p>the event handler function for a <a href="#dfn-load-event"><code>load</code></a> event initiates a new read;</p></li><li><p>the event handler function for a <a href="#dfn-error-event"><code>error</code></a> event initiates a new read.</p></li></ul>
  <div class="note"><div class="noteHeader">Note</div>
  The events <a href="#dfn-loadstart-event"><code>loadstart</code></a> and <a href="#dfn-loadend-event"><code>loadend</code></a> are not coupled in a one-to-one manner.  
  </div>
  <div class="example"><div class="exampleHeader">Example</div>
    <p>
      This example showcases "read-chaining" namely initiating another read from within an event handler while the "first" read continues processing. 
    </p>
    <div class="block"><div class="blockTitleDiv"><span class="blockTitle">ECMAScript</span></div><div class="blockContent"><pre class="code"><code class="es-code">
    <span class="comment">// In code of the sort...</span>
    reader.readAsText(file);
    reader.onload = function(){reader.readAsText(alternateFile);}
    
    .....

    <span class="comment">//... the loadend event must not fire for the first read</span>

    reader.readAsText(file);
    reader.abort();
    reader.onabort = function(){reader.readAsText(updatedFile);}

    <span class="comment">//... the loadend event must not fire for the first read</span>
     
    </code></pre></div></div></div>
    </li>
    <li><p>One <a href="#dfn-progress-event"><code>progress</code></a> event will fire when <a href="#dfn-fileBlob"><code>blob</code></a> has been completely read into memory.  </p></li>
    <li><p>No <a href="#dfn-progress-event"><code>progress</code></a> event fires before <a href="#dfn-loadstart-event"><code>loadstart</code></a>.</p></li>
    <li><p>No <a href="#dfn-progress-event"><code>progress</code></a> event fires after any one of <a href="#dfn-abort-event"><code>abort</code></a>, <a href="#dfn-load-event"><code>load</code></a>, and <a href="#dfn-error-event"><code>error</code></a> have fired.  At most one of <a href="#dfn-abort-event"><code>abort</code></a>, <a href="#dfn-load-event"><code>load</code></a>, and <a href="#dfn-error-event"><code>error</code></a> fire for a given read.</p></li>
    <li><p>No <a href="#dfn-abort-event"><code>abort</code></a>, <a href="#dfn-load-event"><code>load</code></a>, or <a href="#dfn-error-event"><code>error</code></a> event fires after <a href="#dfn-loadend-event"><code>loadend</code></a>.</p></li> 
  </ol>
  </div>
  </div>

</div>
	<div id="readingOnThreads" class="section">
	<h3>8.6 Reading on Threads</h3>
	<p>Web Workers allow for the use of synchronous <a href="#dfn-file"><code>File</code></a> or <a href="#dfn-Blob"><code>Blob</code></a> read APIs,
	since such reads on threads do not block the main thread.
	This section defines a synchronous API, which can be used within Workers [<a href="#Workers">Web Workers</a>].  Workers can avail of both the asynchronous API (the
	<code><a href="#dfn-filereader">FileReader</a></code>
	object) <em>and</em> the synchronous API (the <code><a href="#dfn-FileReaderSync">FileReaderSync</a></code> object).</p>
	<div id="FileReaderSync" class="section">
	<h4>8.6.1. The <code>FileReaderSync</code> API</h4>
	<p>This interface  provides methods to <dfn id="read-method-sync">synchronously read</dfn> <a href="#dfn-file"><code>File</code></a> or <a href="#dfn-Blob"><code>Blob</code>
  </a> objects into memory.</p>
	<div class="block"><div class="blockTitleDiv"><span class="blockTitle">IDL</span></div><div class="blockContent"><pre class="code"><code class="idl-code">

	[Constructor, Exposed=Worker]
	interface <dfn id="dfn-FileReaderSync">FileReaderSync</dfn> {

	  <span class="comment">// Synchronously return strings</span>

	  ArrayBuffer <a href="#dfn-readAsArrayBufferSync">readAsArrayBuffer</a>(<a href="#dfn-Blob">Blob</a> <a href="#dfn-fileBlob">blob</a>); 
	  DOMString <a href="#dfn-readAsTextSync">readAsText</a>(<a href="#dfn-Blob">Blob</a> <a href="#dfn-fileBlob">blob</a>, optional DOMString <a href="#dfn-label">label</a>);
	  DOMString <a href="#dfn-readAsDataURLSync">readAsDataURL</a>(<a href="#dfn-Blob">Blob</a> <a href="#dfn-fileBlob">blob</a>);
	};
	</code></pre></div></div>

	<div id="filereadersyncConstrctr" class="section">
	<h5>8.6.1.1. Constructors</h5>
	<p>When the <code>FileReaderSync()</code> constructor is invoked, the user agent must return a new <a href="#dfn-FileReaderSync"><code>FileReaderSync</code></a> object.</p>
	<p>In environments where the global object is represented by a <code>WorkerGlobalScope</code> object, the <code>FileReaderSync</code> constructor must be available.</p>
	</div>
	<div id="readAsTextSync" class="section">
	<h5>8.6.1.2. The <code>readAsText</code> method</h5>
	<p>When the <dfn id="dfn-readAsTextSync"><code>readAsText(blob, label)</code></dfn> method is called (the
	<a href="#dfn-label"><code>label</code></a> argument is optional), the following steps must be followed:</p>
	<ol>
    <li><p>If <a href="#dfn-readyState"><code>readyState</code></a> = <a href="#dfn-loading"><code>LOADING</code></a> throw an <code>InvalidStateError</code> exception [<a href="#DOM4">DOM4</a>] and terminate these steps.
    </p>

  <p><strong>Note:</strong> The method returns due to the algorithm being <a href="#terminate-an-algorithm">terminated</a>.</p></li>
  <li><p>If the <a href="#dfn-fileBlob"><code>blob</code></a> has been closed through the <a href="#dfn-close"><code>close</code></a> method, throw an <code>InvalidStateError</code> exception [<a href="#DOM4">DOM4</a>] and <a href="#terminate-an-algorithm">terminate this algorithm</a>.</p>
  <p><strong>Note:</strong> The method returns due to the algorithm being <a href="#terminate-an-algorithm">terminated</a>.</p>
  </li> 
	<li><p>Otherwise, initiate a <a href="#readOperation">read operation</a> using the <a href="#dfn-fileBlob"><code>blob</code></a> argument, and with the <a href="#synchronousFlag">synchronous flag</a> <em>set</em>. If the read operation returns failure, throw the <a href="#dfn-error-codes">appropriate exception</a>. <a href="#terminate-an-algorithm">Terminate this algorithm</a>.</p></li>
	<li><p>If no error has occurred, return the <var>result</var> of the <a href="#readOperation">read operation</a> represented as a string in a format determined through the <a href="#encoding-determination">encoding determination</a> algorithm.</p></li>
	</ol>
	</div>
	<div id="readAsDataURLSync-section" class="section">
	<h5>8.6.1.3. The <code>readAsDataURL</code> method</h5>
	<p>
	  When the <dfn id="dfn-readAsDataURLSync"><code>readAsDataURL(blob)</code></dfn> method is called, the following steps must be followed:</p>
	<ol>
	<li><p>If <a href="#dfn-readyState"><code>readyState</code></a> = <a href="#dfn-loading"><code>LOADING</code></a> throw an <code>InvalidStateError</code> exception [<a href="#DOM4">DOM4</a>] and terminate these steps.
    </p>
  <p><strong>Note:</strong> The method returns due to the algorithm being <a href="#terminate-an-algorithm">terminated</a>.</p></li>
  <li><p>If the <a href="#dfn-fileBlob"><code>blob</code></a> has been closed through the <a href="#dfn-close"><code>close</code></a> method, throw an <code>InvalidStateError</code> exception [<a href="#DOM4">DOM4</a>] and <a href="#terminate-an-algorithm">terminate this algorithm</a>.</p>
  <p><strong>Note:</strong> The method returns due to the algorithm being <a href="#terminate-an-algorithm">terminated</a>.</p>
  </li> 
  <li><p>Otherwise, initiate a <a href="#readOperation">read operation</a> using the <a href="#dfn-fileBlob"><code>blob</code></a> argument, and with the <a href="#synchronousFlag">synchronous flag</a> <em>set</em>. If the <a href="#readOperation">read operation</a> returns failure, throw the <a href="#dfn-error-codes">appropriate exception</a>. <a href="#terminate-an-algorithm">Terminate this algorithm</a>.</p></li>
	<li><p>If no error has occurred, return the <var>result</var> of the <a href="#readOperation">read operation</a> 
	as a Data URL [<a href="#DataURL">DataURL</a>] subject to the considerations below.</p>
	<ul>
	  <li>Use the <a href="#dfn-fileBlob"><code>blob</code></a>'s <a href="#dfn-type"><code>type</code></a>
	  attribute as part of the Data URL if it is available in keeping with the Data URL specification [<a href="#DataURL">DataURL</a>] .</li>
	  <li>If the <a href="#dfn-type"><code>type</code></a> attribute is not available on the <a href="#dfn-fileBlob"><code>blob</code></a> return a Data URL without a media-type.
	  [<a href="#DataURL">DataURL</a>].
	  <p>Data URLs that do not have media-types [<a href="#RFC2046">RFC2046</a>] must be treated as plain text by conforming user agents. [<a href="#DataURL">DataURL</a>].</p>
	  
	  </li>
	  </ul>
	</li>
	</ol> 
	</div>
	<div id="readAsArrayBufferSyncSection" class="section">
	<h5>8.6.1.4. The <code>readAsArrayBuffer</code> method</h5>
	<p>When the <dfn id="dfn-readAsArrayBufferSync"><code>readAsArrayBuffer(blob)</code></dfn> method is called, the following steps must be followed:</p>
	<ol>
	<li><p>If <a href="#dfn-readyState"><code>readyState</code></a> = <a href="#dfn-loading"><code>LOADING</code></a> throw an <code>InvalidStateError</code> exception [<a href="#DOM4">DOM4</a>] and terminate these steps.
    </p>
  <p><strong>Note:</strong> The method returns due to the algorithm being <a href="#terminate-an-algorithm">terminated</a>.</p></li>
  <li><p>If the <a href="#dfn-fileBlob"><code>blob</code></a> has been closed through the <a href="#dfn-close"><code>close</code></a> method, throw an <code>InvalidStateError</code> exception [<a href="#DOM4">DOM4</a>] and <a href="#terminate-an-algorithm">terminate this algorithm</a>.</p>
  <p><strong>Note:</strong> The method returns due to the algorithm being <a href="#terminate-an-algorithm">terminated</a>.</p>
  </li> 
  <li><p>Otherwise, initiate a <a href="#readOperation">read operation</a> using the <a href="#dfn-fileBlob"><code>blob</code></a> argument, and with the synchronous flag <em>set</em>. If the <a href="#readOperation">read operation</a> returns failure, throw the <a href="#dfn-error-codes">appropriate exception</a>. <a href="#terminate-an-algorithm">Terminate this algorithm</a>.</p></li>
	<li><p>If no error has occurred, return the <var>result</var> of the <a href="#readOperation">read operation</a> as an <code>ArrayBuffer</code> [<a href="#TypedArrays">TypedArrays</a>]. </p></li>
	</ol>
	</div>
	</div>
	</div>
	<div id="ErrorAndException" class="section">
	  <h2>9. Errors and Exceptions</h2>
	    <p><dfn id="file-error-read">Error conditions</dfn> can occur when reading files from the underlying filesystem.  The list below of potential error conditions is <em>informative</em>.</p>
	    <ul>
	    <li><p>The <a href="#dfn-file"><code>File</code></a> or <a href="#dfn-Blob"><code>Blob</code></a> being accessed may not exist at the time one of the asynchronous <a href="#read-methods">read methods</a> or synchronous
	    <a href="#read-method-sync">read methods</a>
	    are called. This may be due to it having been moved or deleted after a reference to it was acquired (e.g. concurrent modification with another application).  See
	<a href="#dfn-NotFoundError"><code>NotFoundError</code></a></p></li>
	    <li><p>A <a href="#dfn-file"><code>File</code></a> or <a href="#dfn-Blob"><code>Blob</code></a> may be unreadable.  This may be due to permission problems that occur after a reference to a <a href="#dfn-file"><code>File</code></a> or <a href="#dfn-Blob"><code>Blob</code></a> has been acquired
	    (e.g. concurrent lock with another application). Additionally, the <a href="#snapshot-state">snapshot state</a> may have changed.  See <a href="#dfn-NotReadableError"><code>NotReadableError</code></a></p></li>
	    <li><p>User agents MAY determine that some files are unsafe for use within Web applications.  A file may change on disk since the original file selection,
	    thus resulting in an invalid read.  Additionally, some file and directory structures may be considered restricted
	by the underlying filesystem; attempts to read from them may be considered a security violation.  See the <a href="#security-discussion">security considerations</a>.
	See <a href="#dfn-SecurityError"><code>SecurityError</code></a></p></li>
	    
	    </ul>
	<div id="dfn-error-codes" class="section">
	<h3>9.1. Throwing an Exception or Returning an Error</h3>
	<p>This section is normative.  Error conditions can arise when reading a <a href="#dfn-file"><code>File</code></a> or a <a href="#dfn-Blob"><code>Blob</code></a>.</p>

  <p>The <a href="#readOperation">read operation</a> can terminate due to error conditions when reading a <code>File</code> or a <code>Blob</code>; the particular error condition that causes a read operation to return failure or <a href="#queue-a-task">queue a task</a> to <a href="#process-read-error">process read error</a> is called a <dfn id="failureReason">failure reason</dfn>.</p>
	<p>Synchronous read methods <a href="#throw-an-exception">throw</a> exceptions of the type in the table below if there has been an error owing to a particular <a href="#failureReason">failure reason</a>.</p>

	<p>Asynchronous read methods use the <dfn id="dfn-error"><code>error</code></dfn> attribute of the <a href="#dfn-filereader"><code>FileReader</code></a> object, which must return a <dfn id="dfn-domerror">DOMError</dfn> object [<a href="#DOM4">DOM4</a>] of the most appropriate type from the table below if there has been an error owing to a particular <a href="#failureReason">failure reason</a>, or otherwise return null.</p>

	<table><thead><tr><th>Type
	     </th><th>Description and Failure Reason
	   </th></tr></thead><tbody><tr><td><dfn id="dfn-NotFoundError" title="NotFoundError"><code>NotFoundError</code></dfn>
	     </td><td>If the <a href="#dfn-file"><code>File</code></a> or <a href="#dfn-Blob"><code>Blob</code></a> resource could not be found at the time the read was processed, this is the <dfn id="NotFoundFR">NotFound</dfn> <a href="#failureReason">failure reason</a>. For asynchronous read methods the <a href="#dfn-error"><code>error</code></a> attribute must return a "<code>NotFoundError</code>" <a href="#dfn-domerror"><code>DOMError</code></a> and synchronous read methods must <a href="#throw-an-exception">throw</a> a <code>NotFoundError</code> exception.

	    </td></tr><tr><td><dfn id="dfn-SecurityError" title="SecurityError"><code>SecurityError</code></dfn>
	     </td><td>If: <ul>
	     <li>it is determined that certain files are unsafe for access within a Web application, this is the <dfn id="UnsafeFileFR">UnsafeFile</dfn> <a href="#failureReason">failure reason.</a></li>
	     <li>it is determined that too many read calls are being made on <a href="#dfn-file"><code>File</code></a> or <a href="#dfn-Blob"><code>Blob</code></a> resources, this is the <dfn id="TooManyReadsFR">TooManyReads</dfn> <a href="#failureReason">failure reason</a>. </li>
	     </ul>
	     <p>For asynchronous read methods the <a href="#dfn-error"><code>error</code></a> attribute may return a "<code>SecurityError</code>" <a href="#dfn-domerror"><code>DOMError</code></a> and synchronous read methods may <a href="#throw-an-exception">throw</a> a <code>SecurityError</code> exception.</p>
	     <p>This is a security error to be used in situations not covered by any other <a href="#failureReason">failure reason</a>.</p>

	    </td></tr><tr><td><dfn id="dfn-NotReadableError" title="NotReadableError"><code>NotReadableError</code></dfn>
	     </td><td>If: <ul><li>the <a href="#snapshot-state">snapshot state</a> of a <a href="#dfn-file"><code>File</code></a> or a <a href="#dfn-Blob"><code>Blob</code></a> does not match the state of the underlying storage, this is the <dfn id="SnapshotStateFR">SnapshotState</dfn> <a href="#failureReason">failure reason</a>.</li>
       <li>the <a href="#dfn-file"><code>File</code></a> or <a href="#dfn-Blob"><code>Blob</code></a> cannot be read, typically due due to permission problems that occur after a
	     <a href="#snapshot-state">snapshot state</a> has been established (e.g. concurrent lock on the underlying storage with another application) then this is the <dfn id="FileLockFR">FileLock</dfn> <a href="#failureReason">failure reason</a>.</li></ul><p> For asynchronous read methods the  <a href="#dfn-error"><code>error</code></a> attribute must return a "<code>NotReadableError</code>" <a href="#dfn-domerror"><code>DOMError</code></a> and synchronous read methods must <a href="#throw-an-exception">throw</a> a <code>NotReadableError</code> exception.</p>
	    </td></tr></tbody></table>
	</div> 
	</div>
	<div id="url" class="section">  
  <h2>10. A URL for Blob and File reference</h2>
  <p>This section defines a scheme for a URL used to refer to <a href="#dfn-Blob"><code>Blob</code></a> objects (and <a href="#dfn-file"><code>File</code></a> objects). 
  </p>
  <div id="use-cases-scheme" class="section">
  <h3>10.1. Requirements for a New Scheme</h3>
  <p>This specification defines a scheme with URLs of the sort: <code>blob:550e8400-e29b-41d4-a716-446655440000#aboutABBA</code>.
  This section provides some requirements and is an informative discussion.</p>
  <ul>
  <li><p>This scheme should be able to be used with web APIs such as <code>XMLHttpRequest</code> [<a href="#XHR">XHR</a>], and with elements that are designed to be used with HTTP URLs, such as the
  <code>img</code> element [<a href="#HTML">HTML</a>].  In general, this scheme should be designed to be used wherever URLs can be used on the web.  </p>
  <p>This scheme should have defined response codes, so that web applications can respond to scenarios where the resource is not found, or raises an error, etc.
  </p></li>
  <li><p>This scheme should have an <a href="#origin">origin</a> policy and a
  <a href="#lifeTime">lifetime</a> stipulation, to allow safe access to binary data from web applications.  </p>
  <p>URLs in this scheme should be used as a references to "in-memory" <a href="#dfn-Blob">Blobs</a>, and also be re-used elsewhere on the platform to refer to binary
  resources (e.g. for video-conferencing
  [<a href="#WebRTC">WebRTC</a>]).
  URLs in this scheme are designed for impermanence, since they will be typically used to access "in memory" resources.</p></li>
  <li><p>Developers should have the ability to revoke URLs in this scheme, so that they no longer refer to <a href="#dfn-Blob"><code>Blob</code></a> objects.  This includes scenarios
  where file references are no longer needed by a program, but also other uses of <a href="#dfn-Blob"><code>Blob</code></a> objects.
  Consider a scenario where a <a href="#dfn-Blob"><code>Blob</code></a> object can be exported from a drawing program which uses the canvas element and API [<a href="#HTML">HTML</a>].  A snapshot of the drawing can be created by
  exporting a <a href="#dfn-Blob"><code>Blob</code></a>.  This scheme can be used with the <code>img</code> [<a href="#HTML">HTML</a>] element to display the snapshot;
  if the user deletes the snapshot, any reference to the snapshot in memory via a URL should be invalid, and hence the need to be able to revoke such a URL.  </p></li>
  </ul>
  </div>
  <div id="alternative-schemas" class="section">
  <h3>10.2. Discussion of Existing Schemes</h3>
  <p>
  This section is an informative discussion of existing schemes that may have been repurposed or reused for the use cases for URLs above, and justification for why a new scheme
  is considered preferable.  These schemes include HTTP [<a href="#RFC7230">RFC7230</a>], file [<a href="#RFC1630">RFC1630</a>][<a href="#RFC1738">RFC1738</a>], and a scheme such as
  urn:uuid [<a href="#UUID">RFC4122</a>].  One broad consideration in determining what scheme to use is providing something with intuitive appeal to web developers.
  </p>
  <ul>
  <li><p>HTTP could be repurposed for the use cases mentioned above; it already comes with well-defined request-response semantics that are already used by web applications.
  But <a href="#dfn-Blob"><code>Blob</code></a> resources are typically "in-memory"
  resident (e.g. after a file has been read into memory), and are thus unlike "traditional" HTTP resources that are dereferenced via DNS.  While some user agents automatically
  "proxy" the underlying file system on the local machine via an HTTP server (e.g. with URLs of the sort http://localhost), HTTP is not traditionally used with local resources.
  Moreover, an important use case for these URLs are that they can be revoked with an API call.  HTTP URLs have traditionally been used for resources that may be more permanent
  (and that are certainly not chiefly memory-resident, such as files that a web application can read).  Reusing the HTTP scheme might be confusing for web developers owing to well-established
  practice. </p></li>
  <li><p>The reuse of file URLs would involve changes to file URL use today, such as adding response codes.  While they are used inconsistently in web applications,
  the structure of the URLs would change, and request-response behavior would have to be superimposed on what already works in a more-or-less ad-hoc manner.  Modifying this for the use cases
  cited above is imprudent, given legacy usage.  Additionally, the use cases for a Blob URL scheme call for uses beyond the file system.</p></li>
  <li><p>A scheme of the sort urn:uuid [<a href="#UUID">RFC4122</a>] could be used, though use of this scheme is unprecedented in HTML and JavaScript web applications.  The urn:uuid scheme is very generic.  URLs in the scheme urn:uuid have the disadvantage of unfamiliarity and inconsistency across the web platform.  A new scheme has the advantage of being explicit about what is being referenced.  In theory, URLs make no guarantee about what sort of resource is obtained when they are dereferenced; that is left to content labeling and media type.  But in practice, the name of the scheme creates an expectation about both the resource and the protocol of the request-response transaction.  Choosing a name that clarifies the primary use case - namely, access to memory-resident <a href="#dfn-Blob"><code>Blob</code></a> resources - is a worthwhile compromise, and favors clarity, familiarity, and consistency across the web platform.
  </p></li>
  </ul>
  </div>
    <div id="DefinitionOfScheme" class="section">
  <h3>10.3. The Blob URL</h3>
  <p> A Blob URL must consist of the blob: <a href="#scheme">scheme</a> followed by <a href="#scheme-data">scheme data</a> which must consist of a string tuple comprising the <a href="#originOfBlobURL">origin of the Blob URL</a>, the "/" (U+0024 SOLIDUS) character, and a UUID [<a href="#UUID">RFC4122</a>; for an ABNF of UUID, see <a href="#AppendixA">Appendix A</a>]. A Blob URL may contain an optional <a href="#fragmentIDDef">fragment</a>. The Blob URL is serialized as a string according to the <a href="#unicodeBlobURL">Unicode Serialization of a Blob URL</a> algorithm. </p>
<p>A <a href="#fragmentIDDef">fragment</a>, if used,
  has a distinct interpretation depending on the media type of the <a href="#dfn-Blob"><code>Blob</code></a> or <a href="#dfn-file"><code>File</code></a> resource in question (see <a href="#fragmentDiscussion">fragment discussion</a>). </p>
   <div class="block"><div class="blockTitleDiv"><span class="blockTitle">ABNF</span></div><div class="blockContent"><pre class="code"><code class="abnf-code">
  blob = scheme ":" origin "/" UUID [fragIdentifier]

  scheme = "blob"

  ; scheme is always "blob"

  ; origin is a string representation of the <a href="#originOfBlobURL">Blob URL's origin</a>.
  ; UUID is as defined in [<a href="#UUID">RFC4122</a>] and <a href="#AppendixA">Appendix A</a>
  ; fragIdentifier is optional and as defined in [<a href="#RFC3986">RFC3986</a>] and <a href="#AppendixA">Appendix A</a>

  </code></pre></div>
<p>An example of a Blob URL might be <em>blob:https://example.org/9115d58c-bcda-ff47-86e5-083e9a215304</em>.</p>
</div>


  <div id="originOfBlobURL" class="section">
  <h4>10.3.1. Origin of Blob URLs</h4>
  <p><a href="#DefinitionOfScheme">Blob URL</a>s are created using <a href="#dfn-createObjectURL"><code>URL.createObjectURL</code></a> and/or <a href="#dfn-createFor"><code>URL.createFor</code></a>, and are revoked using <a href="#dfn-revokeObjectURL"><code>URL.revokeObjectURL</code></a>. The <a href="#origin">origin</a> of a <a href="#DefinitionOfScheme">Blob URL</a> must be the same as the <a href="#effectiveScriptOrigin">effective script origin</a> specified by the <a href="#incumbentSettingsObject">incumbent settings object</a> at the time the method that created it -- either <a href="#dfn-createObjectURL"><code>URL.createObjectURL</code></a> or <a href="#dfn-createFor"><code>URL.createFor</code></a> -- was called. The <a href="#origin">origin</a> of a Blob URL, when serialized as a string, must conform to the Web Origin Specification's Unicode Serialization of an Origin algorithm [<a href="#WEBORIGIN">ORIGIN</a>]. <a href="#cross-origin-request">Cross-origin requests</a> on Blob URLs must return a <a href="#dfn-networkError">network error</a>.
  </p>
  <div class="note"><div class="noteHeader">Note</div><p>In practice this means that HTTP and HTTPS <a href="#origin">origins</a> are covered by this specification as valid origins for use with Blob URLs. This specification does not address the case of non-HTTP and non-HTTPS <a href="#origin">origins</a>. For instance blob:file:///Users/arunranga/702efefb-c234-4988-a73b-6104f1b615ee (which uses the "file:" <a href="#origin">origin</a>, which is part of the Blob URL's <a href="#scheme-data">scheme data</a>) may have behavior that is undefined, even though user agents may treat such Blob URLs as valid.</p></div>

  </div>
  <div id="unicodeSerializationOfBlobURL" class="section">
 <h4>10.3.2. Unicode Serialization of a Blob URL</h4>

 <p>The <dfn id="unicodeBlobURL">Unicode Serialization of a Blob URL</dfn> is the value returned by the following algorithm, which is invoked by <a href="#dfn-createObjectURL"><code>URL.createObjectURL</code></a> and/or <a href="#dfn-createFor"><code>URL.createFor</code></a>:</p>
 <ol>
    <li><p>Let <var>result</var> be the empty string. Append the string "blob" (that is, the Unicode code point sequence U+0062, U+006C, U+006F, U+0062) to <var>result</var>.</p></li>
  <li><p>Append the ":" (U+003A COLON) character to <var>result</var>.</p></li>
  <li><p>Let <var>O</var> be the <a href="#originOfBlobURL">origin of the Blob URL.</a> If the Unicode Serialization of an Origin algorithm [<a href="#WEBORIGIN">ORIGIN</a>] on <var>O</var> returns null, user agents may substitute an implementation defined value for the return value of the Unicode Serialization of an Origin algorithm. Append the result of the Unicode Serialization of an Origin algorithm for <var>O</var> [<a href="#WEBORIGIN">ORIGIN</a>] to <var>result</var>.</p></li>
  <li><p>Append the "/" character (U+0024 SOLIDUS) to <var>result</var>.</p></li> 
  <li><p>Generate a UUID [<a href="#UUID">RFC4122</a>] as a Unicode string and append it to <var>result</var>.</p></li>
  <li><p>Return <var>result</var>.</p></li>
 </ol>
 
  </div>

  <div class="section" id="fragmentDiscussion">
  <h4>10.3.3. Discussion of Fragment Identifier</h4>
  <p>
  The <a href="#fragmentIDDef">fragment</a>'s resolution and processing directives depend on the media type [<a href="#RFC2046">RFC2046</a>] of a potentially retrieved representation, even though such
  a retrieval is only performed if the <a href="#DefinitionOfScheme">Blob URL</a> is <a href="#dereference">dereferenced</a>.  For example, in an HTML file [<a href="#HTML">HTML</a>] the fragment
  could be used to refer to an anchor within the file.  If the user agent does not recognize the media type of the resource, OR if a fragment is not
  meaningful within the resource, it must ignore the fragment.  The fragment must not be used to identify a resource; only the blob: <a href="#scheme">scheme</a> and the <a href="#scheme-data">scheme data</a> constitute a valid resource identifier.
  </p>
  

  <p>A valid Blob URL reference could look like: <code>blob:http://example.org:8080/550e8400-e29b-41d4-a716-446655440000#aboutABBA</code> where "#aboutABBA" might be an HTML fragment identifier referring to an
  element with an id attribute of "aboutABBA".  </p>
  <div class="note"><div class="noteHeader">Note</div><p>The <a href="#fragmentDiscussion">fragment</a> is not used to identify the resource. Neither the <a href="#dfn-createObjectURL"><code>URL.createObjectURL</code></a> method nor the <a href="#dfn-createFor"><code>URL.createFor</code></a> method generate a fragment. </p></div>

  </div>
</div>
  <div id="requestResponseModel" class="section">
  <h3>10.4. Dereferencing Model for Blob URLs</h3>
<div class="note"><div class="noteHeader">Note</div><p>The <a href="#URL-API">URL</a> and <a href="#Fetch">Fetch</a> Specifications should be considered normative for parsing and fetching <a href="#DefinitionOfScheme">Blob URLs</a>. The section below is for informational purposes only, and is not considered normative.</p></div>
  <p><a href="#DefinitionOfScheme"><code>Blob</code> URL</a>s are <dfn id="dereference">dereferenced</dfn> when the user agent retrieves the resource identified by the Blob URL and returns it to the requesting entity. This section provides guidance on <a href="#requestFetch">requests</a> and <a href="#responseFetch">responses</a>.</p>
  <p>Only <a href="#requestFetch">requests</a> with GET [<a href="#RFC7231">RFC7231</a>] are supported. Specifically, <a href="#responseFetch">responses</a> are only a subset of the following from HTTP [<a href="#RFC7231">RFC7231</a>]:</p>
  <div id="TwoHundredOK" class="section">
  <h4>10.4.1. 200 OK</h4>
  <p>This <a href="#responseFetch">response</a> is used if the <a href="#requestFetch">request</a> has succeeded, and no <a href="#dfn-networkError">network errors</a> are generated.</p> 
  </div>
  <div id="processing-media-types" class="section">
  <h4>10.4.2. Response Headers</h4>
  <p>Along with <a href="#TwoHundredOK">200 OK</a> responses, user agents use a Content-Type header [<a href="#RFC7231">RFC7231</a>] that is equal to the value of the <a href="#dfn-Blob"><code>Blob</code></a>'s <a href="#dfn-type"><code>type</code></a> attribute, if it is not the empty string.</p>
  <p>Along with <a href="#TwoHundredOK">200 OK</a> responses, user agents use a Content-Length header [<a href="#RFC7230">RFC7230</a>] that is equal to the value of the <a href="#dfn-Blob"><code>Blob</code></a>'s <a href="#dfn-size"><code>size</code></a> attribute.</p>
  <p>
  If a Content-Type header [<a href="#RFC7231">RFC7231</a>] is provided, then user agents obtain and process that media type in a manner consistent with the Mime Sniffing specification [<a href="#MIMESNIFF">MIMESNIFF</a>].  
  </p>
  <p>If a resource identified with a <a href="#DefinitionOfScheme">Blob URL</a> is a <a href="#dfn-file"><code>File</code></a> object, user agents use that file's <a href="#dfn-name"><code>name</code></a> attribute, as if the <a href="#responseFetch">response</a> had a <code>Content-Disposition</code> header with the filename parameter set to the <a href="#dfn-file"><code>File</code></a>'s <a href="#dfn-name"><code>name</code></a> attribute [<a href="#RFC6266">RFC6266</a>].  </p>
  <div class="note"><div class="noteHeader">Note</div><p>
  A corollary to this is a non-normative implementation guideline: that the "File Save As" user interface in user agents takes into account the <a href="#dfn-file"><code>File</code></a>'s <code>name</code> attribute if presenting a default name to save the file as.
</p>
  
  </div>

  <div id="NetworkError" class="section">
  <h4>10.4.3. Network Errors</h4>
  <p>
    Responses that do not succeed with a <a href="#TwoHundredOK">200 OK</a> act as if a <dfn id="dfn-networkError">network error</dfn> has occurred [<a href="#Fetch">Fetch</a>].  Network errors are used when:
  </p>
  <ul>
    <li><p>Any <a href="#requestFetch">request</a> method other than GET is used.</p></li>
    <li><p>The <a href="#DefinitionOfScheme">Blob URL</a> does not have an entry in the <a href="#BlobURLStore">Blob URL Store</a>.  </p></li>
    <li><p>The Blob has been <a href="#closed">closed</a>; this also results in the <a href="#DefinitionOfScheme">Blob URL</a> not having an entry in the <a href="#BlobURLStore">Blob URL Store</a>.</p></li>
    <li><p>A <a href="#cross-origin-request">cross-origin request</a> is made on a <a href="#DefinitionOfScheme">Blob URL</a>.</p></li>
    <li><p>A security error has occurred.  </p>
    </li>
  </ul>
  
  </div>
  <div id="ProtocolExamples" class="section">
  <h4>10.4.4. Sample Request and Response Headers</h4>
  <div class="note"><div class="noteHeader">Note</div><p>This section is informative.</p></div>
  <p>This section provides sample exchanges between web applications and user agents using <a href="#DefinitionOfScheme">Blob URLs</a>.  A <a href="#requestFetch">request</a> can be triggered using HTML markup of the sort <code>&lt;img src="blob:http://example.org:8080/550e8400-e29b-41d4-a716-446655440000"&gt;</code>.  These examples merely illustrate the <a href="#requestFetch">request</a> and <a href="#responseFetch">response</a>; web developers are not likely to interact with all the headers, but the <code>getAllResponseHeaders()</code> method of <code>XMLHttpRequest</code>, if used, will show relevant <a href="#responseFetch">response</a> headers [<a href="#XHR">XHR</a>].  </p>
  <div class="example"><div class="exampleHeader">Example</div>
  <p><a href="#requestFetch">Requests</a> could look like this:</p>
  <div class="block"><div class="blockTitleDiv"><span class="blockTitle">HEADERS</span></div><div class="blockContent"><pre class="code"><code class="headers-code">
  GET http://example.org:8080/550e8400-e29b-41d4-a716-446655440000
  </code></pre></div></div>
  <p>If the <a href="#dfn-fileBlob"><code>blob</code></a> has an affiliated media type [<a href="#RFC2046">RFC2046</a>] represented by its <a href="#dfn-type"><code>type</code></a> attribute, then the response message should include the Content-Type header from RFC7231 [<a href="#RFC7231">RFC7231</a>].  See <a href="#processing-media-types">processing media types</a>. </p>
  <div class="block"><div class="blockTitleDiv"><span class="blockTitle">HEADERS</span></div><div class="blockContent"><pre class="code"><code class="headers-code">
  
  200 OK
  Content-Type: image/jpeg
  Content-Length: 21897
  
  ....
  </code></pre></div></div>
  <p>If there is a <a href="#file-error-read">file error</a> associated with the <a href="#dfn-fileBlob"><code>blob</code></a>, then a user agent acts as if a <a href="#dfn-networkError">network error</a> has occurred. </p>
  
  </div>
  
  </div>

  </div>
  <div id="creating-revoking" class="section">
  <h3>10.5. Creating and Revoking a Blob URL</h3>
  <p><a href="#DefinitionOfScheme"><code>Blob</code> URLs</a> are created and revoked using methods exposed on the <a href="#URL-object"><code>URL</code></a> object, supported by
  global objects <code>Window</code> [<a href="#HTML">HTML</a>] and <code>WorkerGlobalScope</code> [<a href="#Workers">Web Workers</a>].  Revocation of a <a href="#DefinitionOfScheme"><code>Blob</code> URL</a>
  decouples the <a href="#DefinitionOfScheme"><code>Blob</code> URL</a> from the resource it refers to, and if it is dereferenced after it is revoked, user agents must act as if a <a href="#dfn-networkError">network error</a> has occurred.
  This section describes a supplemental interface to the URL specification [<a href="#URL-API">URL API</a>] and presents methods for <a href="#DefinitionOfScheme"><code>Blob</code> URL</a> creation and revocation.  </p>
  <div class="block"><div class="blockTitleDiv"><span class="blockTitle">IDL</span></div><div class="blockContent"><pre class="code"><code class="idl-code">

partial interface <dfn id="URL-object" class="dfnrefs">URL</dfn> {

  static DOMString <a href="#dfn-createObjectURL">createObjectURL</a>(<a href="#dfn-Blob">Blob</a> <a href="#dfn-fileBlob">blob</a>);
  static DOMString <a href="#dfn-createFor">createFor</a>(<a href="#dfn-Blob">Blob</a> <a href="#dfn-fileBlob">blob</a>);
  static void <a href="#dfn-revokeObjectURL">revokeObjectURL</a>(DOMString <a href="#dfn-urlarg">url</a>);

};

  </code></pre></div></div>
  <p>ECMAScript user agents of this specification must ensure that they do not expose a <code>prototype</code> property on the URL interface
  object unless the user agent also implements the URL [<a href="#URL-API">URL API</a>] specification. In other words, <code>URL.prototype</code> must
  evaluate to true if the user agent implements the URL [<a href="#URL-API">URL API</a>] specification, and must NOT evaluate to true otherwise.</p>

<div id="createRevokeMethodsParams" class="section">
<h4>10.5.1. Methods and Parameters</h4>   
  <dl><dt id="dfn-createObjectURL">The <code>createObjectURL</code> static method</dt><dd><p>Returns a unique <a href="#DefinitionOfScheme"><code>Blob</code> URL</a>. This method must act as follows:</p>
  <ol>
  <li><p>If called with a <a href="#dfn-Blob"><code>Blob</code></a> argument that has a <a href="#readabilityState">readability state</a> of <a href="#dfn-closedState"><code>CLOSED</code></a>, user agents must return the output of the <a href="#unicodeBlobURL">Unicode Serialization of an Blob URL.</a></p>
    
        <div class="note"><div class="noteHeader">Note</div><p>No entry is added to the <a href="#BlobURLStore">Blob URL Store</a>; consequently, when this <a href="#DefinitionOfScheme">Blob URL</a> is <a href="#dereference">dereferenced</a>, a <a href="#dfn-networkError">network error</a> occurs.</p></div>
  </li>
  <li><p>Otherwise, user agents must run the following sub-steps:</p>
  <ol>
    <li>
      Let <var>url</var> be the result of the <a href="#unicodeBlobURL">Unicode Serialization of a Blob URL</a> algorithm.
    </li>
    <li><a href="#add-an-entry">Add an entry to the Blob URL Store</a> for <var>url</var> and <a href="#dfn-fileBlob"><code>blob</code></a>.</li>
      <li>Return <var>url</var>.</li>
    
  </ol>
</li>
</ol>
</dd>
<dt id="dfn-createFor">The <code>createFor</code> static method</dt><dd><p>Returns a unique <a href="#DefinitionOfScheme"><code>Blob</code> URL</a>; <a href="#DefinitionOfScheme"><code>Blob</code> URL</a>s created with this method are said to be <dfn id="autoRevoking">auto-revoking</dfn> since user-agents are responsible for the revocation of <a href="#DefinitionOfScheme">Blob URL</a>s created with this method, subject to the <a href="#lifeTime">lifetime stipulation</a> for <a href="#DefinitionOfScheme">Blob URL</a>s.  This method must act as follows: </p>
<ol>
  <li><p>If called with a <a href="#dfn-Blob"><code>Blob</code></a> argument that has a <a href="#readabilityState">readability state</a> of <a href="#dfn-closedState"><code>CLOSED</code></a>, user agents must return the output of the <a href="#unicodeBlobURL">Unicode Serialization of a Blob URL.</a>  </p>
        <div class="note"><div class="noteHeader">Note</div><p>No entry is added to the <a href="#BlobURLStore">Blob URL Store</a>; consequently, when this <a href="#DefinitionOfScheme">Blob URL</a> is <a href="#dereference">dereferenced</a>, a <a href="#dfn-networkError">network error</a> occurs.</p></div>
      </li>
  <li><p>Otherwise, user agents must run the following steps:</p>
  <ol>
    <li>Let <var>url</var> be the result of the <a href="#unicodeBlobURL">Unicode Serialization of a Blob URL</a>.     
</li>
    <li><a href="#add-an-entry">Add an entry to the Blob URL Store</a> for <var>url</var> and <a href="#dfn-fileBlob"><code>blob</code></a>.</li>
    <li><a href="#add-an-entry-revoke">Add an entry to the Revocation List</a> for <var>url</var>.</li>
    
      <li>Return <var>url</var>.</li>
  </ol>
</li>
</ol>

    
  <div class="example"><div class="exampleHeader">Example</div>
  <p>In the example below, after obtaining a reference to a <a href="#dfn-Blob"><code>Blob</code></a> object (in this case, a user-selected <a href="#dfn-file"><code>File</code></a> from the underlying file system), the static method <code>URL.createObjectURL()</code> is called on that <a href="#dfn-Blob"><code>Blob</code></a> object.</p>
  <div class="block"><div class="blockTitleDiv"><span class="blockTitle">ECMAScript</span></div><div class="blockContent"><pre class="code"><code class="es-code">
  var file = document.getElementById('file').files[0];
  if(file){
    blobURLref = window.URL.createObjectURL(file);
    myimg.src = blobURLref;

    ....

  }
  </code></pre></div></div>
  </div>
  </dd>
  <dt id="dfn-revokeObjectURL">The <code>revokeObjectURL</code> static method</dt>
  <dd><p>Revokes the <a href="#DefinitionOfScheme">Blob URL</a> provided in the string <a href="#dfn-urlarg"><code>url</code></a> by removing the corresponding entry from the <a href="#BlobURLStore">Blob URL Store</a>.  This method must act as follows:
  </p>
  <ol>
    <li><p>If the <a href="#dfn-urlarg"><code>url</code></a> refers to a <a href="#dfn-Blob"><code>Blob</code></a> that has a <a href="#readabilityState">readability state</a> of <a href="#dfn-closedState"><code>CLOSED</code></a> OR if the value provided for the <a href="#dfn-urlarg"><code>url</code></a> argument is not a <a href="#DefinitionOfScheme"><code>Blob</code> URL</a>, OR if the value provided for the <a href="#dfn-urlarg"><code>url</code></a> argument does not have an entry in the <a href="#BlobURLStore">Blob URL Store</a>,
  this method call does nothing.  User agents may display a message on the error console.</p></li>
    <li><p>Otherwise, user agents must <a href="#removeTheEntry">remove the entry</a> from the <a href="#BlobURLStore">Blob URL Store</a> for <a href="#dfn-urlarg"><code>url</code></a>.</p>
<div class="note"><div class="noteHeader">Note</div><p>Subsequent attemps to dereference <a href="#dfn-urlarg"><code>url</code></a> result in a <a href="#dfn-networkError">network error</a>, since the entry has been removed from the <a href="#BlobURLStore">Blob URL Store</a>.</p></div>
    </li>
  </ol>
  <p><dfn id="dfn-urlarg">The <code>url</code> argument</dfn> to the <a href="#dfn-revokeObjectURL"><code>revokeObjectURL</code></a> method is a <a href="#DefinitionOfScheme">Blob URL</a> string.</p>
  <div class="example"><div class="exampleHeader">Example</div>
  <p>In the example below, <code>window1</code> and <code>window2</code> are separate, but in the <a href="#same-origin">same origin</a>; <code>window2</code> could be an <code>iframe</code>
  [<a href="#HTML">HTML</a>] inside <code>window1</code>.</p>
  <div class="block"><div class="blockTitleDiv"><span class="blockTitle">ECMAScript</span></div><div class="blockContent"><pre class="code"><code class="es-code">
  myurl = window1.URL.createObjectURL(myblob);
  window2.URL.revokeObjectURL(myurl);
  </code></pre></div></div>
  <p>Since <code>window1</code> and <code>window2</code> are in the <a href="#same-origin">same origin</a> and share the same <a href="#BlobURLStore">Blob URL Store</a>, the
  <code>URL.revokeObjectURL</code> call ensures that subsequent dereferencing of <code>myurl</code> results in a the user agent acting as if a <a href="#dfn-networkError">network error</a> has occurred.</p>
  </div>
  </dd>
  </dl>
  </div>
</div>
<div id="examplesOfCreationRevocation" class="section">
<h4>10.5.2. Examples of Blob URL Creation and Revocation</h4>
<p><a href="#DefinitionOfScheme">Blob URL</a>s are strings that are used to <a href="#dereference">dereference</a> <code>Blob</code> objects, and can persist for as long as the <code>document</code> from which they were minted using <a href="#dfn-createObjectURL"><code>URL.createObjectURL()</code></a> or <a href="#dfn-createFor"><code>URL.createFor</code></a>  - see <a href="#lifeTime">Lifetime of Blob URLs</a>.   </p>

<p>This section gives sample usage of creation and revocation of <a href="#DefinitionOfScheme">Blob URL</a>s with explanations.</p>
<div class="example"><div class="exampleHeader">Examples</div>
<p>In the example below, two <code>img</code> elements [<a href="#HTML">HTML</a>] refer to the same <a href="#DefinitionOfScheme">Blob URL</a>:</p>
<div class="block"><div class="blockTitleDiv"><span class="blockTitle">ECMAScript</span></div><div class="blockContent"><pre class="code"><code class="es-code">
&lt;script&gt;url = URL.createObjectURL(blob); &lt;/script&gt;&lt;script&gt; img2.src=url;&lt;/script&gt;
</code></pre></div></div>
<p>
In the example below,  <a href="#dfn-revokeObjectURL"><code>URL.revokeObjectURL()</code></a> is explicitly called.
</p>
<div class="block">
  <div class="blockTitleDiv"><span class="blockTitle">ECMAScript</span></div>
  <div class="blockContent">
  <pre class="code"><code class="es-code">
var blobURLref = URL.createObjectURL(file);
img1 = new Image();
img2 = new Image();

// Both assignments below work as expected

img1.src = blobURLref;
img2.src = blobURLref;

// ... Following body load
// Check if both images have loaded


if(img1.complete &amp;&amp; img2.complete)
{
  // Ensure that subsequent refs throw an exception
  
  URL.revokeObjectURL(blobURLref);
}
else {

  msg("Images cannot be previewed!");
  
  // revoke the string-based reference
  
  URL.revokeObjectURL(blobURLref);

}

</code></pre></div></div>
<p>The example above allows multiple references to a single <a href="#DefinitionOfScheme">Blob URL</a>, and the web developer then revokes the <a href="#DefinitionOfScheme">Blob URL</a> string after both image objects have been loaded.  While not restricting number of uses of the <a href="#DefinitionOfScheme">Blob URL</a> offers more flexibility, it increases the likelihood of leaks; developers should pair it with a corresponding call to <code>URL.revokeObjectURL</code>. </p>
<div class="block"><div class="blockTitleDiv"><span class="blockTitle">ECMAScript</span></div>
<div class="blockContent">
<pre class="code"><code class="es-code">
var blobURLref2 = URL.createFor(file);
img1 = new Image();

img1.src = blobURLref2;

....

</code></pre></div></div>
<p>The example above uses <a href="#dfn-createFor"><code>URL.createFor</code></a>, which allows uses such as the one above, and obviates the need for a corresponding call by the web developer to <a href="#dfn-revokeObjectURL"><code>URL.revokeObjectURL</code></a>.</p>
<div class="block"><div class="blockTitleDiv"><span class="blockTitle">ECMAScript</span></div>
<div class="blockContent">
<pre class="code"><code class="es-code">
// file is an HTML file
// One of the anchor identifiers in file is "#applicationInfo"

var blobURLAnchorRef = URL.createFor(file) + "#applicationInfo";

// openPopup is an utility function to open a small informational window

var windowRef = openPopup(blobURLAnchorRef, "Application Info");


....

</code></pre></div></div>
<p>The example above uses <a href="#dfn-createFor"><code>URL.createFor</code></a> to mint a <a href="#DefinitionOfScheme">Blob URL</a>, and appends a <a href="#fragmentIDDef">fragment</a> that has an understood meaning within the resource (in this case, it references an anchor within the HTML document).</p>
</div>
</div>
<div id="lifeTime" class="section">
  <h3>10.6. Lifetime of Blob URLs</h3>
 <p>A global object which exposes <a href="#dfn-createObjectURL"><code>URL.createObjectURL</code></a> or <a href="#dfn-createFor"><code>URL.createFor</code></a> must maintain a <dfn id="BlobURLStore">Blob URL Store</dfn> which is a list of <a href="#DefinitionOfScheme">Blob URLs</a> created by the <code>URL.createObjectURL</code> method or the <code>URL.createFor</code> method, and the <a href="#dfn-fileBlob"><code>blob</code></a> resource that each refers to. </p>
 <p>A global object which exposes <a href="#dfn-createFor"><code>URL.createFor</code></a> must maintain a <dfn id="revokeList">Revocation List</dfn> which is a list of <a href="#DefinitionOfScheme">Blob URLs</a> created with the <a href="#dfn-createFor"><code>URL.createFor</code></a> method.</p>
 <p>When this specification says to <dfn id="add-an-entry">add an entry to the Blob URL Store</dfn> for a <a href="#DefinitionOfScheme">Blob URL</a> and a <a href="#dfn-fileBlob"><code>blob</code></a> input, the user-agent must add the <a href="#DefinitionOfScheme">Blob URL</a> and a reference to the <a href="#dfn-fileBlob"><code>blob</code></a> it refers to to the <a href="#BlobURLStore">Blob URL Store</a>.</p>
 <p>When this specification says to <dfn id="add-an-entry-revoke">add an entry to the The Revocation List</dfn> for a <a href="#DefinitionOfScheme">Blob URL</a>, user agents must add the <a href="#DefinitionOfScheme">Blob URL</a> to the <a href="#revokeList">Revocation List</a>. This is only for <a href="#autoRevoking">auto-revoking</a> <a href="#DefinitionOfScheme">Blob URL</a>s.</p>
 <p>When this specification says to <dfn id="removeTheEntry">remove an entry from the Blob URL Store</dfn> for a given <a href="#DefinitionOfScheme">Blob URL</a> or for a given <a href="#dfn-Blob"><code>Blob</code></a>, user agents must remove the <a href="#DefinitionOfScheme">Blob URL</a> and the <a href="#dfn-Blob"><code>blob</code></a> it refers to from the <a href="#BlobURLStore">Blob URL Store</a>. Subsequent attempts to <a href="#dereference">dereference</a> this URL must result in a <a href="#dfn-networkError">network error</a>.</p>
 <p>The <a href="#revokeList">Revocation List</a> and the <a href="#BlobURLStore">Blob URL Store</a> must be processed together as follows:</p>
<ol>
  <li>Add <a href="#removeTheEntry">removing the entries</a> for all the <a href="#DefinitionOfScheme">Blob URLs</a> in the <a href="#revokeList">Revocation List</a> to the <a href="#global-script-cleanup-jobs-list">global script cleanup jobs list</a>.</li>
  <li><p>When all the <a href="#DefinitionOfScheme">Blob URL</a>s in the <a href="#revokeList">Revocation List</a> have had their corresponding entries in the <a href="#BlobURLStore">Blob URL Store</a> removed, remove all the <a href="#DefinitionOfScheme">Blob URL</a>s in the <a href="#revokeList">Revocation List</a>.</p>
  </li>
   <li><p>This specification adds an additional <a href="#unloading-document-cleanup-steps">unloading document cleanup step</a> [<a href="#HTML">HTML</a>]: user agents must remove all <a href="#DefinitionOfScheme">Blob URLs</a> from the <a href="#BlobURLStore">Blob URL Store</a> within that <a href="#document">document</a>. </p></li>
</ol>
 <div class="note"><div class="noteHeader">Note</div><p>User agents are free to garbage collect resources removed from the <a href="#BlobURLStore">Blob URL Store</a>.</p></div>

</div>
</div>
	
	<div id="security-discussion" class="section">
	<h2>11. Security Considerations</h2>
	<p>
	  This section is <em>informative.</em>
	</p>
	<p>
	  This specification allows web content to read files from the underlying file system, as well as provides a means for files to be accessed by unique identifiers,
	  and as such is subject to some security considerations.  This specification also assumes that the
	  primary user interaction is with the <code>&lt;input type="file"/&gt;</code> element of HTML forms [<a href="#HTML">HTML</a>], and that all files that are being read by
	  <a href="#dfn-filereader"><code>FileReader</code></a> objects have first been selected by the user.  Important security considerations include preventing malicious file
	  selection attacks (selection looping), preventing access to system-sensitive files, and guarding against modifications of files on disk after a selection has taken place.
	</p>
	<ul><li><p><dfn id="selection-looping">Preventing selection looping.</dfn>  During file selection, a user may be bombarded with the file picker associated with <code>&lt;input
	type="file"/&gt;</code> (in a "must choose" loop that forces selection before the file picker is dismissed) and a user agent may prevent file
	access to any selections by making the  <a href="#dfn-filelist"><code>FileList</code></a> object returned be of size 0.</p></li>
	<li><p><dfn id="sensitive-files">System-sensitive files</dfn> (e.g. files in /usr/bin, password files, and other native operating system executables) typically should not
	be exposed to web content, and should not be accessed via <a href="#DefinitionOfScheme">Blob URLs</a>.  User agents may throw a <a href="#dfn-SecurityError"><code>SecurityError</code></a> exception for synchronous read methods, or return a <a href="#dfn-SecurityError"><code>SecurityError</code></a> <a href="#dfn-domerror"><code>DOMError</code></a> for asynchronous reads.</p></li>
	</ul>
	<div class="ednote"><div class="ednoteHeader">Editorial note</div><p>This section is provisional; more security data may supplement this in subsequent drafts.</p></div>
	</div>
	  <div id="requirements" class="section">
	    <h2>12. Requirements and Use Cases</h2>
	      <p>This section covers what the requirements are for this API, as well as illustrates some use cases.  This version of the API does not satisfy all use cases;
		   subsequent versions may elect to address these.</p>  
		  <ul>
		    <li><p>Once a user has given permission, user agents should provide the ability to read and parse data directly from a local file programmatically.</p>
			  <ul>
			    <li> Example: A lyrics viewer. User wants to read song lyrics from songs in his plist file.  User browses for plist file.  File is opened, 
				 read, parsed, and presented to the user as a sortable, actionable list within a web application.  User can select songs to fetch lyrics.  User uses the 
				 "browse for file" dialog.</li>		
			  </ul>		  		  
		    </li>
		    <li><p>Data should be able to be stored locally so that it is available for later use, which is useful for offline data access for web applications.</p>
			  <ul>
			    <li><p>Example: A Calendar App.  User's company has a calendar. User wants to sync local events to company calendar, marked
	                        as "busy" slots (without leaking personal info).  User browses for file and selects it. The text/calendar file is parsed
	                        in the browser, allowing the user to merge the files to one calendar view.
	                        The user wants to then save the file back to his local calendar file. (using "Save As" ?).  The user can also send the
				integrated calendar file back to the server calendar store asynchronously.</p>
      
      </li>
		          </ul>

		    </li>
		    <li><p>User agents should provide the ability to save a local file programmatically given an amount of data and a file name.</p>
          <div class="note"><div class="noteHeader">Note</div><p>While this specification doesn't provide an explicit API call to trigger downloads, the HTML5 specification has addressed this. The <code>download</code> attribute of the <code>a</code> element [<a href="#HTML">HTML</a>] initiates a download, saving a <a href="#dfn-file"><code>File</code></a> with the name specified. The combination of this API and the <code>download</code> attribute on <code>a</code> elements allows for the creation of files within web applications, and the ability to save them locally.</p></div> 
			  <ul>
			    <li>Example: A Spreadsheet App.  User interacts with a form, and generates some input.  The form then generates a
			        CSV (Comma Separated Variables) output for the user to import into a spreadsheet, and uses "Save...".  The generated
				output can also be directly integrated into a web-based spreadsheet, and
				uploaded asynchronously.</li>  
			  </ul>
		    </li>
		    <li><p>User agents should provide a streamlined programmatic ability to send data from a file to a remote server that works more
		           efficiently than form-based uploads today</p>
			  <ul>
			    <li>Example: A Video/Photo Upload App. User is able to select large files for upload, which can then be "chunk-transfered" to the server.</li>
			  </ul>  
		    </li>
		    <li><p>User agents should provide an API exposed to script that exposes the features above.  The user is notified by UI anytime interaction with the file
			   system takes place, giving the user full ability to cancel or abort the transaction.  The user is notified of any file selections, and can cancel these.
			   No invocations to these APIs occur silently without user intervention. </p>
		    </li>

		  </ul>
	  </div>
	<div id="AppendixA" class="section">
	<h2>13. Appendix A</h2>
	<p>This section uses the Augmented Backus-Naur Form (ABNF), defined in [<a href="#ABNF">RFC5234</a>] to describe components of blob: URLs.
  </p>


  <div id="ABNFUUID" class="section">
	<h3>13.1. An ABNF for UUID</h3>
	<p>The following is an ABNF [<a href="#ABNF">ABNF</a>] for UUID. UUID strings must only use characters in the ranges U+002A to U+002B, U+002D to U+002E, U+0030 to U+0039, U+0041 to U+005A, U+005E to U+007E [<a href="#Unicode">Unicode</a>], and should be at least 36 characters long.</p> 
	<div class="block"><div class="blockTitleDiv"><span class="blockTitle">ABNF</span></div><div class="blockContent"><pre class="code"><code class="abnf-code">
	UUID                   = time-low "-" time-mid "-"
	                         time-high-and-version "-"
	                         clock-seq-and-reserved
	                         clock-seq-low "-" node
	time-low               = 4hexOctet
	time-mid               = 2hexOctet
	time-high-and-version  = 2hexOctet
	clock-seq-and-reserved = hexOctet
	clock-seq-low          = hexOctet
	node                   = 6hexOctet
	hexOctet               = hexDigit hexDigit
	hexDigit =
	         "0" / "1" / "2" / "3" / "4" / "5" / "6" / "7" / "8" / "9" /
	         "a" / "b" / "c" / "d" / "e" / "f" /
	         "A" / "B" / "C" / "D" / "E" / "F"

	</code></pre></div></div>
	</div>
 <div id="ABNFFragment" class="section">
<h3>13.2 An ABNF for Fragment Identifiers</h3>
<div class="block"><div class="blockTitleDiv"><span class="blockTitle">ABNF</span></div><div class="blockContent"><pre class="code"><code class="abnf-code">
  fragIdentifier = "#" fragment

  ; Fragment Identifiers depend on the media type of the Blob
  ; fragment is defined in [<a href="#RFC3986">RFC3986</a>]
  ; fragment processing for HTML is defined in [<a href="#HTML">HTML</a>]

  fragment    = *( pchar / "/" / "?" )

  pchar       = unreserved / pct-encoded / sub-delims / ":" / "@"

  unreserved    = ALPHA / DIGIT / "-" / "." / "_" / "~"

  pct-encoded   = "%" HEXDIG HEXDIG

  sub-delims    = "!" / "$" / "&amp;" / "'" / "(" / ")"
                   / "*" / "+" / "," / ";" / "="
  </code></pre></div></div>
 </div>

	</div>
	   <div id="acknowledgements-section" class="section">
	    <h2>14. Acknowledgements</h2>

	    <p>
	      This specification was originally developed by the SVG Working Group. Many thanks to Mark Baker and Anne van Kesteren for their feedback.</p>
	    <p>Thanks to Robin Berjon for editing the original specification.</p>
	    <p>Special thanks to Olli Pettay, Nikunj Mehta, Garrett Smith, Aaron Boodman, Michael Nordman, Jian Li, Dmitry Titov, Ian Hickson, Darin Fisher, Sam Weinig, Adrian Bateman and Julian Reschke.</p>
	    <p>Thanks to the W3C WebApps WG, and to participants on the public-webapps@w3.org listserv</p>
	  </div>
	  <div id="references" class="section">
	    <h2>15. References</h2>
	      <div id="normative-references" class="section">
	        <h3>15.1. Normative references</h3>
		<dl class="bibliography">
		<dt id="RFC2119">RFC2119</dt>
		<dd><cite><a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a></cite>, S. Bradner. IETF.</dd>
		<dt id="HTML">HTML</dt>
		<dd><cite><a href="http://www.w3.org/TR/html5/">HTML 5: A vocabulary and associated APIs for HTML and XHTML</a></cite>, I. Hickson, R. Berjon, S. Faulkner, T. Leithead, E. Doyle Navara, E. O'Connor, S. Pfeiffer. W3C.</dd>
    <dt id="WEBORIGIN">Web Origin Concept</dt>
    <dd><cite><a href="https://tools.ietf.org/html/rfc6454/">Web Origin Concept</a></cite>, A. Barth. IETF.</dd>
	        <dt id="ProgressEvents">ProgressEvents</dt>
	        <dd><cite><a href="http://www.w3.org/TR/progress-events/">Progress Events</a></cite>, A. van Kesteren. W3C.</dd>
		<dt id="DataURL">RFC2397</dt>
		<dd><cite><a href="https://tools.ietf.org/html/rfc2397">The "data" URL Scheme</a></cite>, L. Masinter. IETF.</dd>
		<dt id="Workers">Web Workers</dt>
		<dd><cite><a href="http://dev.w3.org/html5/workers/">Web Workers (work in progress)</a></cite>, I. Hickson. W3C.</dd>
		<dt id="DOM4">DOM4</dt>
		<dd><cite><a href="http://www.w3.org/TR/domcore/">DOM4 (work in progress)</a></cite>, A. Gregor, A. van Kesteren, Ms2ger. W3C.</dd>
		<dt id="Unicode">Unicode</dt>
		<dd><cite><a href="http://www.unicode.org/versions/Unicode5.2.0/">The Unicode Standard, Version 5.2.0.</a></cite>, J. D. Allen, D. Anderson, et al. Unicode Consortium.</dd>  	
		<dt id="RFC7230">RFC7230</dt>
		<dd><cite><a href="https://tools.ietf.org/html/rfc7230">Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing</a></cite>, R. Fielding, J. Reschke. IETF.</dd>
    <dt id="RFC7231">RFC7231</dt>
    <dd><cite><a href="https://tools.ietf.org/html/rfc7231">Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content</a></cite>, R. Fielding, J. Reschke. IETF.</dd>
		<dt id="RFC2046">RFC2046</dt>
		<dd><cite><a href="https://tools.ietf.org/html/rfc2046">Multipurpose Internet Mail Extensions (MIME) Part Two: Media Extensions</a></cite>, N. Freed, N. Borenstein. IETF.</dd>
    <dt id="RFC6266">RFC6266</dt>
    <dd><cite><a href="https://tools.ietf.org/html/rfc6266">Use of the Content-Disposition Header Field in the Hypertext Transfer Protocol (HTTP)</a></cite>, J. Reschke. IETF.</dd>
	        <dt id="encodingSpecification">Encoding Specification</dt>
	        <dd><cite><a href="https://encoding.spec.whatwg.org/">Encoding Living Standard</a></cite>, A. van Kesteren, J. Bell.</dd>
	        <dt id="streamsSpecification">Streams Specification</dt>
	        <dd><cite><a href="https://streams.spec.whatwg.org/">Sreams Living Standard</a></cite>, Domenic Denicola, Takeshi Yoshino.</dd>
	        <dt id="TypedArrays">Typed Arrays</dt>
	        <dd><cite><a href="https://cvs.khronos.org/svn/repos/registry/trunk/public/webgl/doc/spec/TypedArray-spec.html">Typed Arrays (work in progress)</a></cite>, V. Vukicevic, K. Russell. Khronos Group.</dd>
	        <dt id="ABNF">RFC5234</dt>
	        <dd><cite><a href="https://tools.ietf.org/html/rfc5234">Augmented BNF for Syntax Specifications: ABNF</a></cite>, D. Crocker, P. Overell. IETF.</dd>
	        <dt id="URL-API">URL Specification</dt>
	        <dd><cite><a href="https://url.spec.whatwg.org/">URL Living Standard (work in progress)</a></cite>, A. van Kesteren.</dd>
           <dt id="Fetch">Fetch Specification</dt>
      <dd><cite><a href="https://fetch.spec.whatwg.org">Fetch Specification</a></cite>, A. van Kesteren. WHATWG.</dd>
		<dt id="WebIDL">WebIDL Specification</dt>
		<dd><cite><a href="http://www.w3.org/TR/WebIDL/">WebIDL (work in progress)</a></cite>, C. McCormack.</dd>
		<dt id="ECMA-262">ECMAScript</dt>
		<dd><cite><a href="http://www.ecma-international.org/publications/standards/Ecma-262.htm">ECMAScript 5th Edition</a></cite>, A. Wirfs-Brock, P. Lakshman et al.</dd>
		<dt id="MIMESNIFF">MIME Sniffing</dt>
		<dd><cite><a href="https://mimesniff.spec.whatwg.org/">MIME Sniffing (work in progress)</a></cite>, A. Barth, I. Hickson.</dd>
    <dt id="XHR">XMLHttpRequest</dt>
      <dd><cite><a href="https://xhr.spec.whatwg.org/">XMLHttpRequest Living Standard</a></cite>, A. van Kesteren.</dd>
		</dl>
	      </div>
	    <div id="informative-references" class="section">
	    <h3>15.2. Informative References</h3>
	    <dl>
	    <dt id="Blob-REF">Google Gears Blob API</dt>
	    <dd><cite><a href="https://developers.google.com/gears/?csw=1">Google Gears Blob API (deprecated)</a></cite></dd>
	    <dt id="UUID">RFC4122</dt>
	    <dd><cite><a href="https://tools.ietf.org/html/rfc4122">A Universally Unique IDentifier (UUID) URN Namespace</a></cite>, P. Leach, M. Mealling, R. Salz. IETF.</dd>
	    <dt id="RFC3986">RFC3986</dt>
	    <dd><cite><a href="https://tools.ietf.org/html/rfc3986">Uniform Resource Identifier (URI): Generic Syntax</a></cite>, T. Berners-Lee, R. Fielding, L. Masinter. IETF.</dd>
	    <dt id="RFC1630">RFC1630</dt>
	    <dd><cite><a href="https://tools.ietf.org/html/rfc1630">Universal Resource Identifiers in WWW</a></cite>, T. Berners-Lee. IETF.</dd>
	    <dt id="RFC1738">RFC1738</dt>
	    <dd><cite><a href="https://tools.ietf.org/html/rfc1738">Uniform Resource Locators (URL)</a></cite>, T. Berners-Lee, L. Masinter, M. McCahill. IETF.</dd>
	    <dt id="WebRTC">WebRTC 1.0</dt>
	    <dd><cite><a href="http://dev.w3.org/2011/webrtc/editor/webrtc.html">WebRTC 1.0</a></cite>, A. Bergkvist, D. Burnett, C. Jennings, A. Narayanan. W3C.</dd>
	    </dl>
	    </div>
	    </div>
    </div></div></div>

</div>	    
</body>
</html>
